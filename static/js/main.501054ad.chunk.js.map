{"version":3,"sources":["assets/imgs/icon_logo.svg","libs/THREE-InfiniteGridHelper.js","model/Sixi2.js","three-js-helper.js","components/PoseToImg/PoseToImg.js","components/SimRobot/SimRobot.js","utilities/SegmentControls/SegmentControls.js","components/HistoryTimeline/HistoryTimeline.js","components/SequenceControls/SequenceControls.js","reducers/mainReducer.js","contexts/MainContext.js","components/RightSidebar/RightSidebar.js","components/Login/Login.js","components/Settings/Settings.js","utilities/Accordion/Accordion.js","components/BottomDrawer/BottomDrawer.js","components/CamFeed/CamFeed.js","components/Header/Header.js","components/App/App.js","serviceWorker.js","index.js","assets/imgs/d2drhlh-0c1dc8e8-310b-4f13-b1ed-596c78153401-gray.jpg","assets/objs sync /^/.*$","assets/objs/1_Anchor.obj","assets/objs/2_Shoulder.obj","assets/objs/3_Bicep.obj","assets/objs/4_Forearm.obj","assets/objs/5_TuningFork.obj","assets/objs/6_PicassoBox.obj","assets/objs/7_Hand.obj","assets/objs/8_ClampBase.obj","assets/objs/9_Clamp_Left_Fixed.obj","assets/objs/9_Clamp_Right_Fixed.obj"],"names":["module","exports","InfiniteGridHelper","size1","size2","color","distance","THREE","geometry","material","side","uniforms","uSize1","value","uSize2","uColor","uDistance","transparent","vertexShader","fragmentShader","extensions","derivatives","call","this","frustumCulled","prototype","Sixi2Speeds","velocity","min","max","default","acceleration","Sixi2","x","position","axis","angles","home","objs","y","parent","z","u","v","w","t","t_l","t_r","objLoader","OBJLoader","setupRenderer","width","height","renderer","camera","fov","aspectRatio","setSize","setPixelRatio","window","devicePixelRatio","Math","atan","DEG2RAD","aspect","updateProjectionMatrix","scene","antialias","alpha","preserveDrawingBuffer","canvas","domElement","id","document","body","appendChild","section3dObjects","camDefaultPos","copy","lookAt","imgCache","PoseToImg","pose","cache","props","state","useContext","MainContext","thumbnail","isPoseToImgReady","poseObj","JSON","parse","_","forIn","s","i","rotateSection","render","toDataURL","src","data-pose","alt","SegmentControls","onChange","Number","isInteger","className","style","transform","children","length","map","c","key","childProps","onClick","index","controls","yPos","yLen","zuLen","vFromY","eaLen","yzInitAngle","wristAffector3dObject","wristAffectorControls","endAffector3dObject","endAffectorStart3dObject","endAffectorControls","endAffectorActual3dObject","section3dObjs","endAffectorOffset","vw","loadingManager","grayMatcap","EXRLoader","load","require","yellowMaterial","matcap","silverMaterial","blackMaterial","objNames","Object","values","flatMap","o","filter","objLoadPromise","Promise","all","path","resolve","reject","e","then","forEach","SimRobot","useRef","useEffect","a","current","setupThisRenderer","addEventListener","OrbitControls","enableDamping","enablePan","dampingFactor","rotateSpeed","maxPolarAngle","PI","target","set","pointLight","add","ambientLight","intensity","clone","so","mapValues","postObjLoad","console","log","dispatch","TransformControls","enabled","setSpace","attach","scale","sub","inner","updateMatrixWorld","getWorldPosition","addVectors","subVectors","angleFromSSSTriangle","RAD2DEG","dragging","xyz","wristIK","rotateSections","pos","distanceTo","toFixed","currentState","simPose","endAffectorIK","far","fog","drawLines","useState","endAffectorMode","setEndAffectorMode","ref","object","setMode","offsetWidth","offsetHeight","data","name","sectionOuter","setRotationFromAxisAngle","sectionInner","sectionName","angle","clamp","sectionAngle","datatTo3dObject","section","leftFork","rightFork","offset","factor","toneMapping","toneMappingExposure","outputEncoding","requestAnimationFrame","update","poseLerp","b","lerp","acos","wristLen","xAngle","wristXZ","setY","beta","zAngle","stringify","yLine","xzLine","hypotenuseLine","xzAngle","yAngle","xzCircle","xAxis","p","pUp","eaPos","easPos","wi","uv","getInverse","matrixWorld","applyMatrix4","atan2","angleTo","getWorldQuaternion","quaternion","origin","lineColorGray","angleColor","lineMaterial","lineDashedMaterial","dashSize","gapSize","xLine","setFromPoints","computeLineDistances","drawAngle","translateY","rotateX","curve","reDrawLines","container","arc","toneMapped","fill","undefined","opacity","setAngle","aEndAngle","aClockwise","getPoints","eaPosXZ","hAngle","xzLength","rotation","xRadius","yRadius","currentPose","HistoryTimeline","historySeekPos","poseHistory","historyLockHand","historySeekbarPrecision","class","type","checked","visibility","round","valueAsNumber","showHistoryTimeline","fontSize","step","SequenceControls","sequencePoses","sequenceSeekPos","sequenceEditFrame","showSequenceControl","disabled","onDoubleClick","prevPose","prevBottomExpanded","mainReducer","actionType","sequenceOnSimChange","reducer","online","axios","put","IP","push","isNaN","floor","ceil","historyCurrentPose","sequenceCurrentPose","isPolling","setTimeout","simRobotResize","homePose","sections","realPose","targetPose","initState","camFeedState","camFeedMaximize","showLibrary","createContext","urlStateParamList","mounted","withRouter","location","history","useReducer","stateFromUrl","pick","fromEntries","URLSearchParams","search","setInterval","get","res","catch","err","replace","pathname","toString","Provider","isMounted","setIsMounted","onSubmit","preventDefault","htmlFor","borderRadius","cursor","Accordion","expanded","maxHeight","setState","currentTarget","nextSibling","head","RightSidebar","disableTracksWidthCompensation","SectionInput","href","encodeURIComponent","download","accept","hidden","reader","FileReader","onload","result","readAsText","files","SpeedControls","resetActive","setResetActive","px-8","title","fontFamily","tabIndex","BottomDrawer","process","CamFeed","onLoad","onError","Header","to","reload","component","Login","Settings","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","error","ReactDOM","getElementById","URL","fetch","headers","response","contentType","status","indexOf","ready","unregister","checkValidServiceWorker","webpackContext","req","webpackContextResolve","__webpack_require__","Error","code","keys"],"mappings":"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","file":"static/js/main.501054ad.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/icon_logo.e152c216.svg\";","import * as THREE from 'three'\r\n\r\nexport const InfiniteGridHelper = function InfiniteGridHelper(size1, size2, color, distance) {\r\n\r\n    color = color || new THREE.Color('white');\r\n    size1 = size1 || 10;\r\n    size2 = size2 || 100;\r\n\r\n    distance = distance || 8000;\r\n\r\n    const geometry = new THREE.PlaneBufferGeometry(2, 2, 1, 1);\r\n\r\n    const material = new THREE.ShaderMaterial({\r\n\r\n        side: THREE.DoubleSide,\r\n\r\n        uniforms: {\r\n            uSize1: {\r\n                value: size1\r\n            },\r\n            uSize2: {\r\n                value: size2\r\n            },\r\n            uColor: {\r\n                value: color\r\n            },\r\n            uDistance: {\r\n                value: distance\r\n            }\r\n        },\r\n        transparent: true,\r\n        vertexShader: `\r\n\r\n           varying vec3 worldPosition;\r\n\r\n           uniform float uDistance;\r\n\r\n           void main() {\r\n\r\n                vec3 pos = position.xzy * uDistance;\r\n                pos.xz += cameraPosition.xz;\r\n\r\n                worldPosition = pos;\r\n\r\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\r\n\r\n           }\r\n           `,\r\n\r\n\r\n        fragmentShader: `\r\n\r\n           varying vec3 worldPosition;\r\n\r\n           uniform float uSize1;\r\n           uniform float uSize2;\r\n           uniform vec3 uColor;\r\n           uniform float uDistance;\r\n\r\n\r\n\r\n            float getGrid(float size) {\r\n\r\n                vec2 r = worldPosition.xz / size;\r\n\r\n\r\n                vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\r\n                float line = min(grid.x, grid.y);\r\n\r\n\r\n                return 1.0 - min(line, 1.0);\r\n            }\r\n\r\n           void main() {\r\n\r\n\r\n                  float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);\r\n\r\n                  float g1 = getGrid(uSize1);\r\n                  float g2 = getGrid(uSize2);\r\n\r\n\r\n                  gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));\r\n                  gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);\r\n\r\n                  if ( gl_FragColor.a <= 0.0 ) discard;\r\n\r\n\r\n           }\r\n\r\n           `,\r\n\r\n        extensions: {\r\n            derivatives: true\r\n        }\r\n\r\n    });\r\n\r\n\r\n    THREE.Mesh.call(this, geometry, material);\r\n\r\n    this.frustumCulled = false;\r\n\r\n};\r\n\r\nInfiniteGridHelper.prototype = {\r\n    ...THREE.Mesh.prototype,\r\n    ...THREE.Object3D.prototype,\r\n    ...THREE.EventDispatcher.prototype\r\n};\r\n\r\nexport default InfiniteGridHelper\r\n","// axis: axis of rotation\r\n// angles.home angle (deg)\r\n// angles.min  angle (deg)\r\n// angles.max  angle (deg)\r\n\r\nexport const Sixi2={\r\n\tx: {\r\n\t\tposition: [0,11.32,0],\r\n\t\taxis: [0,-1,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -120,\r\n\t\t\tmax: 120,\r\n\t\t},\r\n\t\tobjs: ['2_Shoulder.obj'],\r\n\t},\r\n\ty: {\r\n\t\tposition: [0,7.524,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: -90,\r\n\t\t\tmin: -170,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['3_Bicep.obj'],\r\n\t\tparent: 'x',\r\n\t},\r\n\tz: {\r\n\t\tposition: [0,35.796,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -83.369,\r\n\t\t\tmax: 86,\r\n\t\t},\r\n\t\tobjs: ['4_Forearm.obj'],\r\n\t\tparent: 'y',\r\n\t},\r\n\tu: {\r\n\t\tposition: [29.207,6.406,0],\r\n\t\taxis: [-1,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -175,\r\n\t\t\tmax: 175,\r\n\t\t},\r\n\t\tobjs: ['5_TuningFork.obj'],\r\n\t\tparent: 'z',\r\n\t},\r\n\tv: {\r\n\t\tposition: [9.513,0,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -120,\r\n\t\t\tmax: 120,\r\n\t\t},\r\n\t\tobjs: ['6_PicassoBox.obj'],\r\n\t\tparent: 'u',\r\n\t},\r\n\tw: {\r\n\t\tposition: [5.423,0,0],\r\n\t\taxis: [-1,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -170,\r\n\t\t\tmax: 170,\r\n\t\t},\r\n\t\tobjs: ['7_Hand.obj'],\r\n\t\tparent: 'v',\r\n\t},\r\n\tt: {\r\n\t\tposition: [0,0,0],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 180,\r\n\t\t\tmin: 10,\r\n\t\t\tmax: 180,\r\n\t\t},\r\n\t\tobjs: ['8_ClampBase.obj'],\r\n\t\tparent: 'w',\r\n\t},\r\n\tt_l: {\r\n\t\tposition: [10.634,0,-4.05],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['9_Clamp_Left_Fixed.obj'],\r\n\t\tparent: 't',\r\n\t},\r\n\tt_r: {\r\n\t\tposition: [10.634,0,4.05],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['9_Clamp_Right_Fixed.obj'],\r\n\t\tparent: 't',\r\n\t},\r\n}\r\n\r\nexport const Sixi2Speeds={\r\n\tvelocity: {\r\n\t\tmin: 0,\r\n\t\tmax: 50,\r\n\t\tdefault: 25,\r\n\t},\r\n\tacceleration: {\r\n\t\tmin: 0,\r\n\t\tmax: 100,\r\n\t\tdefault: 10,\r\n\t}\r\n}\r\n\r\nexport default Sixi2\r\n","import * as THREE from 'three'\r\nimport {OBJLoader} from 'three/examples/jsm/loaders/OBJLoader'\r\nexport const objLoader=new OBJLoader()\r\n\r\nexport function objLoaderAsync(path){\r\n\treturn new Promise((resolve,reject)=>{\r\n\t\ttry{ objLoader.load(path,o=>resolve(o),null,null,null) }\r\n\t\tcatch(e){ reject(e) }\r\n\t})\r\n}\r\n\r\n// Returns angle between (-180,180]\r\nexport function normalizeAngle(angle){\r\n\tangle=angle%360\r\n\tangle=(angle+360)%360\r\n\tif(angle>180) angle-=360\r\n\treturn angle\r\n}\r\n\r\nexport function setupRenderer(width,height,renderer,camera,fov=45){\r\n\tconst aspectRatio=width/height\r\n\r\n\trenderer.setSize(width,height)\r\n\trenderer.setPixelRatio(window.devicePixelRatio)\r\n\t// renderer.setPixelRatio(1) // Low quality, high performance for higher density displays\r\n\r\n\t// Universal desktop and mobile friendly FOV algorithm\r\n\tcamera.fov=fov*(aspectRatio>1?1:Math.atan(1/aspectRatio)/THREE.Math.DEG2RAD/45)\r\n\tcamera.aspect=aspectRatio\r\n\tcamera.updateProjectionMatrix()\r\n}\r\n\r\nexport function vectorConsoleFormat(v){\r\n\treturn v.toArray().map(c=>+c.toFixed(2))\r\n}\r\n","import React,{useContext} from 'react'\r\nimport * as THREE from 'three'\r\n// import {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport _ from 'lodash'\r\n\r\nimport './PoseToImg.scss'\r\nimport {postObjLoad} from '../SimRobot/SimRobot'\r\nimport {MainContext,dispatch} from '../../contexts/MainContext'\r\nimport {setupRenderer} from '../../three-js-helper'\r\n\r\n// NOTE: Maybe blobs (about 20% better memory efficiency)\r\n\r\nconst renderer=new THREE.WebGLRenderer({\r\n\tantialias:             true,\r\n\talpha:                 true,\r\n\tpreserveDrawingBuffer: true,\r\n})\r\n\r\nconst canvas=renderer.domElement\r\ncanvas.id='PoseToImgCanvas'\r\ndocument.body.appendChild(canvas)\r\n\r\nlet scene\r\nlet section3dObjs={}\r\nconst section3dObjects={}\r\n\r\nconst camera=new THREE.PerspectiveCamera()\r\nconst camDefaultPos=new THREE.Vector3(200,200,200)\r\ncamera.position.copy(camDefaultPos)\r\ncamera.lookAt(0,30,0)\r\n// const controls=new OrbitControls(camera,canvas)\r\n// controls.enableDamping=true\r\n// controls.enablePan=false\r\n// controls.dampingFactor=.1\r\n// controls.rotateSpeed=.5\r\n// controls.maxPolarAngle=Math.PI/2\r\n// controls.target.set(0,30,0)\r\nsetupRenderer(320,240,renderer,camera,20)\r\n\r\nfunction render(){\r\n\t// requestAnimationFrame(render)\r\n\t// controls.update()\r\n\trenderer.render(scene,camera)\r\n}\r\n\r\nexport function initPoseToImg(s,so){\r\n\tscene=s\r\n\tsection3dObjs=so\r\n\t// console.log(scene,section3dObjs)\r\n\r\n\tpostObjLoad(scene,section3dObjs,section3dObjects,renderer)\r\n\tconsole.log('PoseToImgReady')\r\n\tdispatch(['SET_STATE',{isPoseToImgReady:true}])\r\n}\r\n\r\nconst imgCache=/*JSON.parse(localStorage.getItem('imgCache')) ??*/ {}\r\nexport default function PoseToImg({pose,cache,...props}){\r\n\tconst {state}=useContext(MainContext)\r\n\tlet thumbnail=imgCache[pose]\r\n\r\n\tif(state.isPoseToImgReady && !thumbnail){\r\n\t\tconst poseObj=JSON.parse(pose)\r\n\t\t_.forIn(section3dObjects,(s,i)=>s.rotateSection(poseObj[i]))\r\n\t\trender()\r\n\t\tthumbnail=canvas.toDataURL()\r\n\t\tif(cache!==false){\r\n\t\t\timgCache[pose]=thumbnail\r\n\t\t\t// try{ localStorage.setItem('imgCache',JSON.stringify(imgCache)) }catch(e){ console.error(e) }\r\n\t\t}\r\n\t}\r\n\r\n\t// console.log(imgCache)\r\n\treturn <img src={thumbnail} {...props} data-pose={pose} alt=\"\"/>\r\n}\r\n","import React,{useRef,useEffect,Fragment,useState} from 'react'\r\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport {TransformControls} from 'three/examples/jsm/controls/TransformControls'\r\nimport {EXRLoader} from 'three/examples/jsm/loaders/EXRLoader'\r\nimport * as THREE from 'three'\r\nimport _ from 'lodash'\r\nimport InfiniteGridHelper from '../../libs/THREE-InfiniteGridHelper'\r\n// import {Line2} from 'three/examples/jsm/lines/Line2'\r\n// import {LineGeometry} from 'three/examples/jsm/lines/LineGeometry'\r\n// import {LineMaterial} from 'three/examples/jsm/lines/LineMaterial'\r\n\r\nimport './SimRobot.scss'\r\nimport Sixi2 from '../../model/Sixi2'\r\nimport {initPoseToImg} from '../PoseToImg/PoseToImg'\r\nimport {objLoaderAsync,setupRenderer,vectorConsoleFormat} from '../../three-js-helper'\r\nimport SegmentControls from '../../utilities/SegmentControls/SegmentControls'\r\nimport {currentState} from '../../reducers/mainReducer'\r\nimport {dispatch} from '../../contexts/MainContext'\r\n\r\nexport let canvas\r\nexport let renderer\r\nexport let scene\r\nexport let camera\r\nexport const camDefaultPos=new THREE.Vector3(250,200,250)\r\nexport let controls\r\nexport const section3dObjs={}\r\nexport const section3dObjects={}\r\nexport let cameraPos\r\n\r\nexport let yPos\r\nexport let yLen\r\nexport let zuLen\r\nexport let vFromY\r\nexport let eaLen\r\nexport let yzInitAngle\r\n\r\nexport let wristAffector3dObject\r\nexport let wristAffectorControls\r\n\r\nexport let endAffectorOffset=new THREE.Vector3(12.5,0,0)\r\nexport let endAffector3dObject\r\nexport let endAffectorStart3dObject\r\nexport let endAffectorControls\r\nexport const vw=new THREE.Vector3(5.423,0,0)\r\nexport let endAffectorActual3dObject\r\n\r\nexport const loadingManager=new THREE.LoadingManager()\r\nexport const exrLoader=new EXRLoader(loadingManager)\r\nexport const textureLoader=new THREE.TextureLoader(loadingManager)\r\n\r\n// export const yellowMatcap=exrLoader.load(require('../../assets/imgs/skintone-yellow.exr'))\r\n// export const grayMatcap=exrLoader.load(require('../../assets/imgs/skintone-gray.exr'))\r\n// export const grayMatcap=textureLoader.load(require('../../assets/imgs/6f106fee8cd42335efe16cf4f7250ecf7c284a83.png'))\r\n\r\nexport const grayMatcap=textureLoader.load(require('../../assets/imgs/d2drhlh-0c1dc8e8-310b-4f13-b1ed-596c78153401-gray.jpg'))\r\n\r\n// export const yellowMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(50,100%,25%)'),matcap: yellowMatcap})\r\n// export const silverMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(0,0%,25%)'),matcap: grayMatcap})\r\n// export const blackMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(0,0%,2%)'),matcap: grayMatcap})\r\n\r\nexport const yellowMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(0,0%,100%)'),matcap: grayMatcap})\r\nexport const silverMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(0,0%,10%)'),matcap: grayMatcap})\r\nexport const blackMaterial=new THREE.MeshMatcapMaterial({color: new THREE.Color('hsl(0,0%,2%)'),matcap: grayMatcap})\r\n\r\nexport const objNames=['1_Anchor.obj',...Object.values(Sixi2).flatMap(o=>o.objs)].filter(o=>o)\r\nexport const objLoadPromise=Promise.all(objNames.map(o=>objLoaderAsync(require('../../assets/objs/'+o)))).then(o=>{\r\n\to.forEach((o,i)=>section3dObjs[objNames[i]]=o)\r\n})\r\n\r\nexport default function SimRobot(){\r\n\tcanvas=useRef()\r\n\tuseEffect(componentDidMount,[])\r\n\tconst [endAffectorMode,setEndAffectorMode]=useState(0)\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<canvas id=\"SimRobot\" ref={canvas}></canvas>\r\n\t\t\t<div id=\"IKControls\" className=\"row spc-12\">\r\n\t\t\t\t<div className=\"my-0 ml-0 button-icon\" onClick={()=>controls.object.position.copy(camDefaultPos)}>\r\n\t\t\t\t\t<div className=\"fa fa-repeat text-muted\" style={{transform: 'rotateY(180deg)'}}/>\r\n\t\t\t\t\t<div>Reset View</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<div className=\"h7\">End Affector Control Mode</div>\r\n\t\t\t\t<SegmentControls\r\n\t\t\t\t\tclassName=\"m-2\"\r\n\t\t\t\t\tstyle={{width: '100px'}}\r\n\t\t\t\t\tvalue={endAffectorMode}\r\n\t\t\t\t\tonChange={changeEndEffectorMode}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Fragment>Move</Fragment>\r\n\t\t\t\t\t<Fragment>Rotate</Fragment>\r\n\t\t\t\t</SegmentControls>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t)\r\n\r\n\tfunction componentDidMount(){\r\n\t\t(async function initRenderer(){\r\n\t\t\trenderer=new THREE.WebGLRenderer({\r\n\t\t\t\tantialias:             true,\r\n\t\t\t\tcanvas:                canvas.current,\r\n\t\t\t\talpha:                 true,\r\n\t\t\t\tpreserveDrawingBuffer: true,\r\n\t\t\t})\r\n\r\n\t\t\tscene=new THREE.Scene()\r\n\t\t\tcamera=new THREE.PerspectiveCamera()\r\n\t\t\tcamera.position.copy(camDefaultPos)\r\n\t\t\tcamera.lookAt(0,30,0)\r\n\r\n\t\t\tsetupThisRenderer()\r\n\t\t\twindow.addEventListener('resize',setupThisRenderer,true)\r\n\r\n\t\t\tcontrols=new OrbitControls(camera,renderer.domElement)\r\n\t\t\tcontrols.enableDamping=true\r\n\t\t\tcontrols.enablePan=false\r\n\t\t\tcontrols.dampingFactor=.1\r\n\t\t\tcontrols.rotateSpeed=.5\r\n\t\t\tcontrols.maxPolarAngle=Math.PI/2\r\n\t\t\tcontrols.target.set(0,30,0)\r\n\r\n\t\t\tconst pointLight=new THREE.PointLight()\r\n\t\t\tpointLight.position.set(0,100,0)\r\n\t\t\tscene.add(pointLight)\r\n\t\t\tconst ambientLight=new THREE.AmbientLight()\r\n\t\t\tambientLight.intensity=.25\r\n\t\t\tscene.add(ambientLight)\r\n\r\n\t\t\tawait objLoadPromise\r\n\t\t\t// console.log(scene,section3dObjs)\r\n\t\t\tinitPoseToImg(scene.clone(),_.mapValues(section3dObjs,o=>o.clone()))\r\n\r\n\t\t\tpostObjLoad(scene,section3dObjs,section3dObjects,renderer)\r\n\r\n\t\t\twristAffector3dObject=new THREE.Object3D()\r\n\t\t\tscene.add(wristAffector3dObject)\r\n\r\n\t\t\twristAffectorControls=new TransformControls(camera,renderer.domElement)\r\n\t\t\twristAffectorControls.addEventListener('dragging-changed',({value})=>controls.enabled=!value)\r\n\t\t\twristAffectorControls.setSpace('local')\r\n\t\t\twristAffectorControls.attach(wristAffector3dObject)\r\n\t\t\tscene.add(wristAffectorControls)\r\n\t\t\twristAffectorControls.scale.set(0,0,0)\r\n\r\n\t\t\tendAffector3dObject=new THREE.Mesh(\r\n\t\t\t\tnew THREE.SphereBufferGeometry(1,32,32),\r\n\t\t\t\tnew THREE.MeshLambertMaterial()\r\n\t\t\t)\r\n\t\t\tscene.add(endAffector3dObject)\r\n\r\n\t\t\tendAffectorStart3dObject=new THREE.Object3D()\r\n\t\t\tendAffectorStart3dObject.position.sub(endAffectorOffset)\r\n\t\t\tendAffectorStart3dObject.position.sub(vw)\r\n\t\t\tendAffector3dObject.add(endAffectorStart3dObject)\r\n\r\n\t\t\tendAffectorActual3dObject=new THREE.Object3D()\r\n\t\t\tendAffectorActual3dObject.position.copy(endAffectorOffset)\r\n\t\t\tsection3dObjects['w'].inner.add(endAffectorActual3dObject)\r\n\r\n\t\t\tendAffectorControls=new TransformControls(camera,renderer.domElement)\r\n\t\t\tendAffectorControls.addEventListener('dragging-changed',({value})=>controls.enabled=!value)\r\n\t\t\tendAffectorControls.setSpace('local')\r\n\t\t\tendAffectorControls.attach(endAffector3dObject)\r\n\t\t\tscene.add(endAffectorControls)\r\n\r\n\t\t\tscene.updateMatrixWorld()\r\n\t\t\tsection3dObjects['v'].getWorldPosition(wristAffector3dObject.position)\r\n\t\t\tendAffectorActual3dObject.getWorldPosition(endAffector3dObject.position)\r\n\r\n\t\t\t// console.log(section3dObjects['x'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['y'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['z'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['u'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['v'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['w'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['t'].getWorldPosition())\r\n\r\n\t\t\tyPos=new THREE.Vector3()\r\n\t\t\tsection3dObjects['y'].getWorldPosition(yPos)\r\n\t\t\tyLen=section3dObjects['z'].position.length()\r\n\t\t\tzuLen=new THREE.Vector3().addVectors(section3dObjects['u'].position,section3dObjects['v'].position).length()\r\n\t\t\tvFromY=new THREE.Vector3()\r\n\t\t\tvFromY.subVectors(wristAffector3dObject.position,yPos)\r\n\t\t\teaLen=vFromY.length()\r\n\t\t\tyzInitAngle=angleFromSSSTriangle(eaLen,zuLen,yLen)*THREE.Math.RAD2DEG\r\n\r\n\t\t\t// TODO: Cleanup redundency\r\n\t\t\twristAffectorControls.addEventListener('change',()=>{\r\n\t\t\t\tif(wristAffectorControls.dragging){\r\n\t\t\t\t\tconst xyz=wristIK(wristAffector3dObject.position)\r\n\t\t\t\t\trotateSections(xyz)\r\n\t\t\t\t\tscene.updateMatrixWorld()\r\n\t\t\t\t\tlet pos=new THREE.Vector3()\r\n\t\t\t\t\tsection3dObjects['v'].getWorldPosition(pos)\r\n\t\t\t\t\tif(pos.distanceTo(wristAffector3dObject.position).toFixed(2)==='0.00')\r\n\t\t\t\t\t\tdispatch(['SET_SIM_ANGLES',{\r\n\t\t\t\t\t\t\t...currentState.simPose,\r\n\t\t\t\t\t\t\t...xyz,\r\n\t\t\t\t\t\t}])\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\trotateSections(currentState.simPose)\r\n\t\t\t\t\t\tscene.updateMatrixWorld()\r\n\t\t\t\t\t\tpos=new THREE.Vector3()\r\n\t\t\t\t\t\tsection3dObjects['v'].getWorldPosition(pos)\r\n\t\t\t\t\t}\r\n\t\t\t\t\twristAffector3dObject.position.copy(pos)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tendAffectorControls.addEventListener('change',endAffectorIK)\r\n\r\n\t\t\tscene.add(new InfiniteGridHelper(10,100,new THREE.Color('hsl(0,0%,50%)'),camera.far/2.75))\r\n\t\t\tscene.fog=new THREE.Fog(new THREE.Color('hsl(230,10%,10%)'),camera.far/2,camera.far)\r\n\t\t\tdrawLines()\r\n\t\t\trender()\r\n\t\t})()\r\n\t}\r\n\r\n\tfunction changeEndEffectorMode(i){\r\n\t\tswitch(i){\r\n\t\t\tcase 0:\r\n\t\t\t\tendAffectorControls.setMode('translate')\r\n\t\t\t\tbreak\r\n\t\t\tcase 1:\r\n\t\t\t\tendAffectorControls.setMode('rotate')\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t}\r\n\t\tsetEndAffectorMode(i)\r\n\t}\r\n}\r\n\r\nexport function setupThisRenderer(){\r\n\tsetupRenderer(\r\n\t\tcanvas.current.offsetWidth,\r\n\t\tcanvas.current.offsetHeight,\r\n\t\trenderer,\r\n\t\tcamera,\r\n\t\t20\r\n\t)\r\n}\r\n\r\nexport function postObjLoad(scene,section3dObjs,section3dObjects,renderer){\r\n\t_.forIn(Sixi2,(s,i)=>section3dObjects[i]=datatTo3dObject(s,i,section3dObjs,section3dObjects))\r\n\r\n\tconst section=section3dObjects['t'].inner\r\n\tconst leftFork=section.children[1].inner\r\n\tconst rightFork=section.children[2].inner\r\n\tsection3dObjects['t'].rotateSection=function(offset){\r\n\t\t// NOTE: Verify and remove .7\r\n\t\tconst factor=(offset-Sixi2['t'].angles.max)/Sixi2['t'].angles.max*.7\r\n\t\tleftFork.position.z=factor*Sixi2['t_l'].position[2]\r\n\t\trightFork.position.z=factor*Sixi2['t_r'].position[2]\r\n\t}\r\n\tscene.add(section3dObjs['1_Anchor.obj'])\r\n\tscene.add(section3dObjects['x'])\r\n\r\n\tsection3dObjs['1_Anchor.obj'].children[0].material=yellowMaterial\r\n\tsection3dObjs['1_Anchor.obj'].children[1].material=blackMaterial\r\n\r\n\tsection3dObjs['2_Shoulder.obj'].children[0].material=blackMaterial\r\n\tsection3dObjs['2_Shoulder.obj'].children[1].material=silverMaterial\r\n\tsection3dObjs['2_Shoulder.obj'].children[2].material=blackMaterial\r\n\tsection3dObjs['2_Shoulder.obj'].children[3].material=yellowMaterial\r\n\r\n\tsection3dObjs['3_Bicep.obj'].children[0].material=yellowMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[1].material=silverMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[2].material=blackMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[3].material=yellowMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[4].material=yellowMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[5].material=yellowMaterial\r\n\tsection3dObjs['3_Bicep.obj'].children[6].material=yellowMaterial\r\n\r\n\tsection3dObjs['4_Forearm.obj'].children[ 0].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 1].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 2].material=silverMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 3].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 4].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 5].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 6].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 7].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 8].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[ 9].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[10].material=silverMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[11].material=silverMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[12].material=silverMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[13].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[14].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[15].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[16].material=yellowMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[17].material=silverMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[18].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[19].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[20].material=blackMaterial\r\n\tsection3dObjs['4_Forearm.obj'].children[21].material=yellowMaterial\r\n\r\n\tsection3dObjs['5_TuningFork.obj'].children[0].material=yellowMaterial\r\n\tsection3dObjs['6_PicassoBox.obj'].children[0].material=yellowMaterial\r\n\tsection3dObjs['7_Hand.obj'].children[0].material=yellowMaterial\r\n\r\n\tsection3dObjs['8_ClampBase.obj'].children[0].material=blackMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[1].material=blackMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[2].material=yellowMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[3].material=yellowMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[4].material=blackMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[5].material=blackMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[6].material=blackMaterial\r\n\tsection3dObjs['8_ClampBase.obj'].children[7].material=yellowMaterial\r\n\r\n\tsection3dObjs['9_Clamp_Left_Fixed.obj'].children[0].material=yellowMaterial\r\n\tsection3dObjs['9_Clamp_Right_Fixed.obj'].children[0].material=yellowMaterial\r\n\r\n\t// renderer.toneMapping=THREE.CineonToneMapping\r\n\t// renderer.toneMapping=THREE.ReinhardToneMapping\r\n\trenderer.toneMapping=THREE.ACESFilmicToneMapping\r\n\trenderer.toneMappingExposure=4\r\n\trenderer.outputEncoding=THREE.sRGBEncoding\r\n}\r\n\r\nexport function datatTo3dObject(data,name,section3dObjs,section3dObjects){\r\n\tconst axis=new THREE.Vector3(...data.axis)\r\n\tconst sectionOuter=new THREE.Object3D()\r\n\tsectionOuter.name='section-'+name\r\n\tsectionOuter.position.set(...data.position)\r\n\tsectionOuter.setRotationFromAxisAngle(axis,data.angles.home*THREE.Math.DEG2RAD)\r\n\r\n\tconst sectionInner=new THREE.Object3D()\r\n\tsectionOuter.add(sectionInner)\r\n\tsectionInner.name='section-'+name+'-inner'\r\n\tdata.objs.map(o=>sectionInner.add(section3dObjs[o]))\r\n\r\n\tsectionOuter.sectionName=name\r\n\tsectionOuter.inner=sectionInner\r\n\tsectionOuter.axis=axis\r\n\tsectionOuter.rotateSection=function(angle){\r\n\t\tangle=THREE.Math.clamp(angle,data.angles.min,data.angles.max)\r\n\t\tif(sectionOuter.sectionAngle===angle) return\r\n\t\tsectionOuter.sectionAngle=angle\r\n\t\tsectionInner.setRotationFromAxisAngle(axis,-angle*THREE.Math.DEG2RAD)\r\n\t}\r\n\tsectionOuter.rotateSection(data.angles.home)\r\n\r\n\tif(data.parent)\r\n\t\tsection3dObjects[data.parent].inner.add(sectionOuter)\r\n\treturn sectionOuter\r\n}\r\n\r\nfunction render(){\r\n\trequestAnimationFrame(render)\r\n\tcontrols.update()\r\n\tcameraPos=controls.object.position\r\n\trenderer.render(scene,camera)\r\n}\r\n\r\nexport function poseLerp(a,b,alpha){\r\n\treturn _.mapValues(a,(v,i)=>THREE.Math.lerp(a[i],b[i],alpha))\r\n}\r\n\r\n// TODO: Add to helper lib\r\nfunction angleFromSSSTriangle(a,b,c){\r\n\treturn Math.acos((b**2+c**2-a**2)/(2*b*c))\r\n}\r\n\r\nfunction wristIK(pos){\r\n\tpos=vFromY.subVectors(pos,yPos)\r\n\tconst wristLen=pos.length()\r\n\r\n\tlet xAngle=-Math.atan(pos.z/pos.x)*THREE.Math.RAD2DEG\r\n\tif(pos.x<0)\r\n\t\tif(pos.z>0) xAngle=xAngle-180\r\n\t\telse xAngle=180+xAngle\r\n\r\n\tconst wristXZ=pos.clone().setY(0).length()\r\n\tconst alpha=Math.atan(pos.y/wristXZ)*THREE.Math.RAD2DEG\r\n\tconst beta=angleFromSSSTriangle(zuLen,yLen,wristLen)*THREE.Math.RAD2DEG || 0\r\n\r\n\tconst zAngle=angleFromSSSTriangle(wristLen,zuLen,yLen)*THREE.Math.RAD2DEG || 180\r\n\treturn {\r\n\t\tx: xAngle,\r\n\t\ty: -alpha-beta,\r\n\t\tz: yzInitAngle-zAngle,\r\n\t}\r\n}\r\n\r\nexport function rotateSections(data){\r\n\tdata=JSON.parse(JSON.stringify(data))\r\n\tfor(let i in data){\r\n\t\tdata[i]=THREE.Math.clamp(data[i],Sixi2[i].angles.min,Sixi2[i].angles.max)\r\n\t\tsection3dObjects[i].rotateSection(data[i])\r\n\t}\r\n\treturn data\r\n}\r\n\r\nconst xAxis=new THREE.Vector3(1,0,0)\r\nconst p=new THREE.Object3D()\r\nconst pUp=new THREE.Object3D()\r\npUp.position.set(0,1,0)\r\np.add(pUp)\r\nexport function endAffectorIK(){\r\n\tif(!endAffectorControls.dragging) return\r\n\r\n\tscene.updateMatrixWorld()\r\n\tconst eaPos=new THREE.Vector3()\r\n\tendAffector3dObject.getWorldPosition(eaPos)\r\n\tconst easPos=new THREE.Vector3()\r\n\tendAffectorStart3dObject.getWorldPosition(easPos)\r\n\r\n\tconst xyz=wristIK(easPos)\r\n\trotateSections(xyz)\r\n\tsection3dObjects['x'].updateMatrixWorld()\r\n\r\n\tconst a=new THREE.Vector3()\r\n\tconst wi=new THREE.Matrix4()\r\n\tconst uv={}\r\n\r\n\ta.copy(eaPos)\r\n\twi.getInverse(section3dObjects['u'].matrixWorld)\r\n\ta.applyMatrix4(wi)\r\n\tuv.u=Math.atan2(a.z,a.y)*THREE.Math.RAD2DEG\r\n\r\n\ta.copy(eaPos)\r\n\twi.getInverse(section3dObjects['v'].matrixWorld)\r\n\ta.applyMatrix4(wi)\r\n\tuv.v=-a.angleTo(xAxis)*THREE.Math.RAD2DEG\r\n\r\n\t// for stability around zeros (especially home pos)\r\n\t// if(uv.u>0){\r\n\t// \tuv.u-=180\r\n\t// \tuv.v*=-1\r\n\t// }\r\n\r\n\trotateSections(uv)\r\n\tsection3dObjects['u'].updateMatrixWorld()\r\n\r\n\tendAffectorActual3dObject.getWorldPosition(p.position)\r\n\tendAffector3dObject.getWorldQuaternion(p.quaternion)\r\n\tp.updateMatrixWorld()\r\n\tpUp.getWorldPosition(a)\r\n\twi.getInverse(section3dObjects['w'].matrixWorld)\r\n\ta.applyMatrix4(wi)\r\n\tconst w=Math.atan2(a.z,a.y)*THREE.Math.RAD2DEG\r\n\trotateSections({w})\r\n\r\n\tdispatch(['SET_SIM_ANGLES_IK',{\r\n\t\t...currentState.simPose,\r\n\t\t...xyz,\r\n\t\t...uv,\r\n\t\tw\r\n\t}])\r\n}\r\n\r\nexport function alignEndAffector(){\r\n\tscene.updateMatrixWorld()\r\n\tsection3dObjects['v'].getWorldPosition(wristAffector3dObject.position)\r\n\tendAffectorActual3dObject.getWorldPosition(endAffector3dObject.position)\r\n\tendAffectorActual3dObject.getWorldQuaternion(endAffector3dObject.quaternion)\r\n}\r\n\r\nlet yLine\r\nlet xzLine\r\nlet hypotenuseLine\r\nlet xzAngle\r\nlet yAngle\r\nlet xzCircle\r\nconst origin=new THREE.Vector3()\r\nconst lineColorGray=new THREE.Color('hsl(60, 0%, 2%)')\r\nconst angleSize=15\r\nconst angleDivisions=90\r\nconst angleColor=new THREE.Color('hsl(45, 100%, 53%)')\r\nconst lineMaterial=new THREE.LineBasicMaterial({color: lineColorGray})\r\nconst lineDashedMaterial=new THREE.LineDashedMaterial({\r\n\tcolor: lineColorGray,\r\n\tdashSize: 1,\r\n\tgapSize: .5,\r\n})\r\nexport function drawLines(){\r\n\tyLine=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tlineMaterial,\r\n\t)\r\n\tscene.add(yLine)\r\n\r\n\txzLine=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tlineMaterial,\r\n\t)\r\n\tscene.add(xzLine)\r\n\r\n\thypotenuseLine=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tlineDashedMaterial,\r\n\t)\r\n\tscene.add(hypotenuseLine)\r\n\r\n\tconst xLine=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tlineDashedMaterial,\r\n\t)\r\n\txLine.geometry.setFromPoints([origin,new THREE.Vector3(1000,0,0)])\r\n\txLine.computeLineDistances()\r\n\tscene.add(xLine)\r\n\r\n\txzAngle=drawAngle()\r\n\t// xzAngle.children[1].renderOrder=1\r\n\txzAngle.translateY(0.15)\r\n\txzAngle.rotateX(Math.PI/2)\r\n\tscene.add(xzAngle)\r\n\r\n\tyAngle=drawAngle()\r\n\tscene.add(yAngle)\r\n\r\n\txzCircle=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tlineDashedMaterial,\r\n\t)\r\n\txzCircle.curve=new THREE.EllipseCurve(\r\n\t\t0,0,\r\n\t\t1,1,\r\n\t\t0,2*Math.PI,\r\n\t\tfalse,\r\n\t\t0,\r\n\t)\r\n\txzCircle.rotateX(Math.PI/2)\r\n\tscene.add(xzCircle)\r\n\r\n\treDrawLines()\r\n}\r\n\r\nfunction drawAngle(){\r\n\tconst container=new THREE.Object3D()\r\n\r\n\tconst arc=new THREE.Line(\r\n\t\tnew THREE.BufferGeometry(),\r\n\t\tnew THREE.LineBasicMaterial({color: angleColor}),\r\n\t)\r\n\tarc.curve=new THREE.EllipseCurve(\r\n\t\t0,0,\r\n\t\tangleSize,angleSize,\r\n\t\t0,2*Math.PI,\r\n\t\tfalse,\r\n\t\t0,\r\n\t)\r\n\tarc.material.toneMapped=false\r\n\tcontainer.add(arc)\r\n\r\n\tconst fill=new THREE.Mesh(\r\n\t\tundefined,\r\n\t\tnew THREE.MeshBasicMaterial({\r\n\t\t\tcolor: angleColor,\r\n\t\t\topacity: .125,\r\n\t\t}),\r\n\t)\r\n\tfill.material.side=THREE.DoubleSide\r\n\tfill.material.transparent=true\r\n\tfill.material.toneMapped=false\r\n\tcontainer.add(fill)\r\n\r\n\treturn container\r\n}\r\n\r\nfunction setAngle(container,angle){\r\n\tconst [arc,fill]=container.children\r\n\tarc.curve.aEndAngle=angle>=0?angle:Math.PI*2+angle\r\n\tarc.curve.aClockwise=angle<0\r\n\tarc.geometry.setFromPoints(arc.curve.getPoints(angleDivisions)) // Check performance\r\n\tfill.geometry=new THREE.CircleGeometry(angleSize,angleDivisions,0,angle) // Check performance\r\n}\r\n\r\nexport function reDrawLines(){\r\n\tconst eaPos=new THREE.Vector3()\r\n\tendAffector3dObject.getWorldPosition(eaPos)\r\n\tconst eaPosXZ=eaPos.clone()\r\n\teaPosXZ.setY(0)\r\n\r\n\tyLine.geometry.setFromPoints([eaPos,eaPosXZ])\r\n\txzLine.geometry.setFromPoints([eaPosXZ,origin])\r\n\r\n\thypotenuseLine.geometry.setFromPoints([origin,eaPos])\r\n\thypotenuseLine.computeLineDistances()\r\n\r\n\tconst hAngle=Math.atan2(eaPosXZ.z,eaPosXZ.x)\r\n\tconst xzLength=eaPosXZ.length()\r\n\tsetAngle(xzAngle,hAngle)\r\n\tsetAngle(yAngle,Math.atan2(eaPos.y,xzLength))\r\n\tyAngle.rotation.y=-hAngle\r\n\txzCircle.curve.xRadius=xzLength\r\n\txzCircle.curve.yRadius=xzLength\r\n\txzCircle.geometry.setFromPoints(xzCircle.curve.getPoints(90))\r\n\txzCircle.computeLineDistances()\r\n}\r\n// TODO: Collision detection\r\n","import React from 'react'\r\n// import _ from 'lodash'\r\n\r\nimport './SegmentControls.scss'\r\n\r\nexport default function SegmentControls({onChange,...props}){\r\n\tconst value=Number.isInteger(props.value)?props.value:-1\r\n\treturn (\r\n\t\t<div {...props} className={'segment-controls row '+props.className}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"highlight\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\ttransform: `translateX(${value*100}%)`,\r\n\t\t\t\t\twidth: 100/props.children.length+'%',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{props.children.map((c,i)=><div key={i} {...props.childProps} onClick={()=>onClick(i)}>{c}</div>)}\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction onClick(index){\r\n\t\ttry{ onChange(index,value) }catch{}\r\n\t}\r\n}\r\n","import React,{useContext,/*Fragment*/} from 'react'\r\n\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport './HistoryTimeline.scss'\r\nimport PoseToImg from '../PoseToImg/PoseToImg'\r\n\r\n// NOTE: Maybe UI Toggle\r\n// TODO: Scroll\r\n\r\nexport let currentPose\r\nexport default function HistoryTimeline(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {historySeekPos,poseHistory,simPose,historyLockHand,historySeekbarPrecision}=state\r\n\tif(historySeekPos===poseHistory.length) currentPose=JSON.stringify(simPose)\r\n\treturn (\r\n\t\t<div id=\"HistoryTimeline\">\r\n\t\t\t<div className=\"row top-row\">\r\n\t\t\t\t<div className=\"f-center px-8 py-4 spb-x-8\">\r\n\t\t\t\t\t<div className=\"fa fa-history\"/>\r\n\t\t\t\t\t<div className=\"b-700\">History Timeline</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"f-center px-8 py-4 pr-0\">\r\n\t\t\t\t\t<span className=\"h7 f-center\"><i class=\"fa fa-lock mr-8 h6\"/>Lock hand while scrubbing timeline</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"ml-8\"\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tchecked={historyLockHand}\r\n\t\t\t\t\t\tonChange={({target})=>{dispatch(['HISTORY_LOCK_HAND',target.checked])}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row f-center spc-x-8 spc-4\" style={{visibility: poseHistory.length?'visible':'hidden'}}>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_backward\" onClick={()=>dispatch(['HISTORY_SEEK',poseHistory.length])}/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_backward\" onClick={()=>dispatch(['HISTORY_SEEK',Math.round(historySeekPos)+1])}/>\r\n\t\t\t\t\t<span className=\"h7\">Slider position</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"text-center h7 b-500\"\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tvalue={historySeekPos}\r\n\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['HISTORY_SEEK',valueAsNumber])}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_forward\" onClick={()=>dispatch(['HISTORY_SEEK',Math.round(historySeekPos)-1])}/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_forward\" onClick={()=>dispatch(['HISTORY_SEEK',0])}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/*<div className=\"f-center px-8 py-4 pr-0\">\r\n\t\t\t\t\t<span className=\"h7\">Smooth Seekbar</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"ml-8\"\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tchecked={historySeekbarPrecision==2}\r\n\t\t\t\t\t\tonChange={({target})=>{dispatch(['SET_STATE',{historySeekbarPrecision: target.checked?2:1}])}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>*/}\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<div className=\"fa fa-minus f-center px-16\" onClick={()=>dispatch(['SET_STATE',{showHistoryTimeline: false}])}/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"scroll-x\">\r\n\t\t\t\t<div className=\"seekbar f-center\">\r\n\t\t\t\t\t<div className=\"super-center h7 pr-8\" style={{fontSize: '13px'}}><i className=\"fa fa-chevron-down mr-4 h8\"/>Current</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tposeHistory.length>=1?\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tmax={poseHistory.length}\r\n\t\t\t\t\t\t\t\tstep={1/10**historySeekbarPrecision}\r\n\t\t\t\t\t\t\t\tvalue={historySeekPos}\r\n\t\t\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['HISTORY_SEEK',valueAsNumber])}\r\n\t\t\t\t\t\t\t\tstyle={{'--width': (poseHistory.length)*144+'px'}}\r\n\t\t\t\t\t\t\t/>:undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex\">\r\n\t\t\t\t\t<div className=\"p-8 current d-flex\">\r\n\t\t\t\t\t\t<PoseToImg cache={false} pose={currentPose} onClick={()=>dispatch(['HISTORY_SEEK',poseHistory.length])}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"needle button\" style={{opacity: poseHistory.length,transform: `translateX(${-72+(poseHistory.length-historySeekPos)*144}px)`}}/>\r\n\t\t\t\t\t<div className=\"f-grow-1 row spc-8 spc-x-16 px-0 f-nowrap f-horz-rev f-justify-end\">\r\n\t\t\t\t\t\t{poseHistory.map((p,i)=><PoseToImg key={i} pose={p} onClick={()=>dispatch(['HISTORY_SEEK',i])}/>)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext,Fragment} from 'react'\r\n\r\nimport './SequenceControls.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport PoseToImg from '../PoseToImg/PoseToImg'\r\n\r\nexport let currentPose\r\nexport default function SequenceControls(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {sequencePoses,sequenceSeekPos,simPose,sequenceEditFrame}=state\r\n\tif(sequenceSeekPos===sequencePoses.length) currentPose=JSON.stringify(simPose)\r\n\treturn (\r\n\t\t<div id=\"SequenceControls\">\r\n\t\t\t<div className=\"top-row row\">\r\n\t\t\t\t<div className=\"f-center px-8 py-4 spb-x-8\">\r\n\t\t\t\t\t<div className=\"icon icon-layout_directed\"/>\r\n\t\t\t\t\t<div className=\"b-700\">Sequence Controls</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{sequenceEditFrame===undefined?\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<div className=\"row f-center spc-x-8 spc-4\" style={{visibility: sequencePoses.length?'visible':'hidden'}}>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"outline super-center h7 icon icon-fast_backward\"\r\n\t\t\t\t\t\t\t\tonClick={()=>dispatch(['SEQ_SEEK',0])}/>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"outline super-center h7 icon icon-step_backward\"\r\n\t\t\t\t\t\t\t\tonClick={()=>dispatch(['SEQ_SEEK',Math.round(sequenceSeekPos)-1])}/>\r\n\t\t\t\t\t\t\t<span className=\"h7\">Slider position</span>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tclassName=\"text-center h7 b-500\"\r\n\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\tvalue={sequenceSeekPos+1}\r\n\t\t\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['SEQ_SEEK',valueAsNumber-1])}/>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"outline super-center h7 icon icon-step_forward\"\r\n\t\t\t\t\t\t\t\tonClick={()=>dispatch(['SEQ_SEEK',Math.round(sequenceSeekPos)+1])}/>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"outline super-center h7 icon icon-fast_forward\"\r\n\t\t\t\t\t\t\t\tonClick={()=>dispatch(['SEQ_SEEK',sequencePoses.length])}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t\t<div className=\"row spc-x-8 spc-y-4\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName=\"outline super-center\"\r\n\t\t\t\t\t\t\t\tstyle={{fontSize: '14px'}}\r\n\t\t\t\t\t\t\t\tonClick={()=>dispatch(['SET_STATE',{sequencePoses: [],sequenceSeekPos: 0}])}>\r\n\t\t\t\t\t\t\t\t<i className=\"fa fa-times mr-6\"/>\r\n\t\t\t\t\t\t\t\tClear\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Fragment>:\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<button className=\"h7 my-4 mx-8 py-0 px-8 b-600 super-center\" onClick={()=>dispatch(['SEQ_EDIT',undefined])}>\r\n\t\t\t\t\t\t\t<i className=\"fa fa-times mr-4\"/>\r\n\t\t\t\t\t\t\tExit Edit Mode\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t\t</Fragment>}\r\n\t\t\t\t{/* TODO: Unhide */}\r\n\t\t\t\t{/*<div className=\"row spc-x-8 spc-4\">\r\n\t\t\t\t\t<button className=\"outline super-center\" style={{fontSize: '14px'}}>\r\n\t\t\t\t\t\t<i className=\"fa fa-bookmark mr-6\"/>\r\n\t\t\t\t\t\tSave Sequence\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>*/}\r\n\t\t\t\t<div className=\"fa fa-minus f-center px-16 ml-auto\" onClick={()=>dispatch(['SET_STATE',{showSequenceControl: false}])}/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"scroll-x\">\r\n\t\t\t\t<div className=\"seekbar f-center\" style={{height: '30px'}}>\r\n\t\t\t\t\t<div className=\"h7 text-center pr-8\" style={{width: '72px'}}>Seekbar</div>\r\n\t\t\t\t\t{sequencePoses.length>=1?\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tmax={sequencePoses.length}\r\n\t\t\t\t\t\t\t\tstep={1/100}\r\n\t\t\t\t\t\t\t\tvalue={sequenceSeekPos}\r\n\t\t\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['SEQ_SEEK',valueAsNumber])}\r\n\t\t\t\t\t\t\t\tstyle={{'--width': (sequencePoses.length)*144+'px'}}\r\n\t\t\t\t\t\t\t\tdisabled={sequenceEditFrame!==undefined}/>\r\n\t\t\t\t\t\t\t<div className=\"h7 ml-16\">{\r\n\t\t\t\t\t\t\t\t(sequenceEditFrame===undefined)?\r\n\t\t\t\t\t\t\t\t\t'Double click a keyframe to edit':\r\n\t\t\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t\t}</div>\r\n\t\t\t\t\t\t</Fragment>:undefined}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row spc-8 spc-x-16 px-0 f-nowrap\">\r\n\t\t\t\t\t{state.sequencePoses.map((p,i)=><div\r\n\t\t\t\t\t\tclassName=\"poseimg-container\"\r\n\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\tstyle={{opacity: sequenceEditFrame!==undefined && sequenceEditFrame!==i?.5:1}}>\r\n\t\t\t\t\t\t<div className=\"fa fa-minus\" onClick={()=>dispatch(['SEQ_DEL',i])}/>\r\n\t\t\t\t\t\t<PoseToImg\r\n\t\t\t\t\t\t\tpose={p}\r\n\t\t\t\t\t\t\tonClick={()=>dispatch([sequenceEditFrame!==undefined?'SEQ_EDIT':'SEQ_SEEK',i])}\r\n\t\t\t\t\t\t\tonDoubleClick={()=>dispatch(['SEQ_EDIT',i])}\r\n\t\t\t\t\t\t\tcache={sequenceEditFrame!==i}/>\r\n\t\t\t\t\t</div>)}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName={'needle button'+(sequenceEditFrame!==undefined?' edit-mode':'')}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: +(sequencePoses.length && (sequenceSeekPos!==sequencePoses.length)),\r\n\t\t\t\t\t\t\ttransform: `translateX(${72-(sequencePoses.length-sequenceSeekPos)*144}px)`\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonDoubleClick={()=>{ if(sequenceEditFrame!==undefined) dispatch(['SEQ_EDIT',undefined]) }}/>\r\n\t\t\t\t\t{sequenceEditFrame===undefined?\r\n\t\t\t\t\t\t<div className=\"fa fa-plus\" onClick={()=>dispatch(['SEQ_ADD'])}/>: // TODO: Dashed border png\r\n\t\t\t\t\t\tundefined\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","// import _ from 'lodash'\r\nimport * as THREE from 'three'\r\nimport axios from 'axios'\r\n\r\nimport {\r\n\t// section3dObjects,\r\n\tsetupThisRenderer as simRobotResize,\r\n\tposeLerp,\r\n\t// scene as simScene,\r\n\t// wristAffector3dObject,\r\n\trotateSections,\r\n\talignEndAffector,reDrawLines,\r\n} from '../components/SimRobot/SimRobot'\r\n// import Sixi2 from '../model/Sixi2'\r\nimport {currentPose as historyCurrentPose} from '../components/HistoryTimeline/HistoryTimeline'\r\nimport {currentPose as sequenceCurrentPose} from '../components/SequenceControls/SequenceControls'\r\n\r\nexport let currentState={}\r\nexport let prevPose\r\nexport let prevBottomExpanded\r\nexport const mainReducer=(state,[actionType,data])=>{\r\n\tcurrentState=reducer(state,actionType,data)\r\n\tif(currentState.isPolling==='false') currentState.isPolling=false\r\n\tif(currentState.isPolling==='true') currentState.isPolling=true\r\n\tif(prevBottomExpanded !== (+state.showHistoryTimeline+state.showSequenceControl)){\r\n\t\tconsole.log('Bottom drawer changed')\r\n\t\twindow.setTimeout(simRobotResize,0)\r\n\t\tprevBottomExpanded=+state.showHistoryTimeline+state.showSequenceControl\r\n\t}\r\n\r\n\tfunction sequenceOnSimChange(){\r\n\t\tif(currentState.sequenceEditFrame===undefined)\r\n\t\t\tcurrentState.sequenceSeekPos=state.sequencePoses.length\r\n\t\telse\r\n\t\t\tcurrentState.sequencePoses[currentState.sequenceSeekPos]=JSON.stringify(currentState.simPose)\r\n\t}\r\n\tif(actionType==='SET_SIM_ANGLES' || actionType==='SET_SIM_ANGLES_IK'){\r\n\t\tcurrentState.historySeekPos=state.poseHistory.length\r\n\t\tsequenceOnSimChange()\r\n\t}\r\n\tif(actionType==='HISTORY_SEEK')\r\n\t\tsequenceOnSimChange()\r\n\tif(actionType==='SEQ_SEEK')\r\n\t\tcurrentState.historySeekPos=state.poseHistory.length\r\n\r\n\t// console.log(data,actionType,currentState)\r\n\treturn currentState\r\n}\r\n\r\n// RULE: Do not touch currentState in reducer()\r\nfunction reducer(state,actionType,data){\r\n\tlet pose\r\n\tlet a\r\n\tlet b\r\n\tlet c\r\n\tlet p\r\n\tlet alpha\r\n\t// let pos\r\n\r\n\tswitch(actionType){\r\n\t\tcase 'SET_STATE':\r\n\t\t\treturn {...state,...data}\r\n\t\tcase 'SET_SIM_ANGLES':\r\n\t\t\tdata=rotateSections(data)\r\n\t\t\talignEndAffector()\r\n\t\t\treDrawLines()\r\n\t\t\treturn {...state,simPose: data}\r\n\t\tcase 'SET_SIM_ANGLES_IK':\r\n\t\t\treDrawLines()\r\n\t\t\treturn {...state,simPose: rotateSections(data)}\r\n\t\tcase 'GO':\r\n\t\t\t// TODO: check\r\n\t\t\tif(state.online) axios.put(`https://${state.IP}:7878/goto`,state.simPose)\r\n\t\t\tpose=JSON.stringify(state.simPose)\r\n\t\t\tif(prevPose!==pose){\r\n\t\t\t\tstate.poseHistory.push(pose)\r\n\t\t\t\tstate.historySeekPos=state.poseHistory.length\r\n\t\t\t\tprevPose=pose\r\n\t\t\t}\r\n\t\t\treturn {...state}\r\n\r\n\t\tcase 'HISTORY_SEEK':\r\n\t\t\tif(isNaN(+data)) data=0\r\n\t\t\tdata=THREE.Math.clamp(+data,0,state.poseHistory.length)\r\n\t\t\ta=Math.floor(data)\r\n\t\t\tb=Math.ceil(data)\r\n\t\t\talpha=data%1\r\n\t\t\t// const alpha=data%1\r\n\t\t\tc=JSON.parse(historyCurrentPose)\r\n\t\t\ta=a>=state.poseHistory.length?c:JSON.parse(state.poseHistory[a])\r\n\t\t\tb=b>=state.poseHistory.length?c:JSON.parse(state.poseHistory[b])\r\n\t\t\tp=poseLerp(a,b,alpha)\r\n\t\t\tif(state.historyLockHand) p['t']=c['t']\r\n\t\t\treturn reducer({...state,historySeekPos: data},'SET_SIM_ANGLES',p)\r\n\t\tcase 'HISTORY_LOCK_HAND':\r\n\t\t\treturn reducer({...state,historyLockHand: data},'HISTORY_SEEK',state.historySeekPos)\r\n\r\n\t\t// TODO: duplicate check\r\n\t\tcase 'SEQ_SEEK':\r\n\t\t\tif(isNaN(+data)) data=0\r\n\t\t\tdata=THREE.Math.clamp(+data,0,state.sequencePoses.length)\r\n\t\t\ta=Math.floor(data)\r\n\t\t\tb=Math.ceil(data)\r\n\t\t\talpha=data%1\r\n\t\t\t// const alpha=data%1\r\n\t\t\tc=JSON.parse(sequenceCurrentPose)\r\n\t\t\ta=a>=state.sequencePoses.length?c:JSON.parse(state.sequencePoses[a])\r\n\t\t\tb=b>=state.sequencePoses.length?c:JSON.parse(state.sequencePoses[b])\r\n\t\t\tp=poseLerp(a,b,alpha)\r\n\t\t\treturn reducer({...state,sequenceSeekPos: data},'SET_SIM_ANGLES',p)\r\n\t\tcase 'SEQ_ADD':\r\n\t\t\tpose=JSON.stringify(state.simPose)\r\n\t\t\tif(state.sequencePoses.length && state.sequencePoses[state.sequencePoses.length-1]===pose)\r\n\t\t\t\treturn state\r\n\t\t\tstate.sequencePoses.push(pose)\r\n\t\t\tstate.sequenceSeekPos=state.sequencePoses.length\r\n\t\t\treturn {...state}\r\n\t\tcase 'SEQ_EDIT':\r\n\t\t\tif(data===undefined)\r\n\t\t\t\treturn {...state,sequenceEditFrame: undefined}\r\n\t\t\telse{\r\n\t\t\t\tdata=THREE.Math.clamp(data,0,state.sequencePoses.length-1)\r\n\t\t\t\treturn reducer({...state,sequenceEditFrame: data},'SEQ_SEEK',data)\r\n\t\t\t}\r\n\t\tcase 'SEQ_DEL':\r\n\t\t\treturn reducer({...state,sequencePoses: state.sequencePoses.filter((p,i)=>i!==data)},'SEQ_SEEK',state.sequenceSeekPos)\r\n\t\tdefault: return state\r\n\t}\r\n}\r\n","import React,{createContext,useReducer,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport axios from 'axios'\r\n\r\nimport {mainReducer} from '../reducers/mainReducer'\r\nimport sections from '../model/Sixi2'\r\nimport {currentState} from '../reducers/mainReducer'\r\n\r\nexport let dispatch\r\nexport const prodMode=true\r\n\r\n// TODO: Update port\r\nexport const homePose=JSON.stringify(_.mapValues(sections,s=>s.angles.home))\r\nexport let realPose=JSON.parse(homePose)\r\nexport let targetPose=JSON.parse(homePose)\r\nexport const initState=JSON.stringify({\r\n\tisPolling: prodMode?true:false,\r\n\tIP: '',\r\n\r\n\tsimPose: JSON.parse(homePose),\r\n\tonline: false,\r\n\tcamFeedState: 'searching',\r\n\tcamFeedMaximize: false,\r\n\tisPoseToImgReady: false,\r\n\r\n\tshowHistoryTimeline: true,\r\n\tshowSequenceControl: false,\r\n\tshowLibrary: false,\r\n\r\n\tposeHistory: [],\r\n\thistorySeekPos: 0,\r\n\thistoryLockHand: true,\r\n\thistorySeekbarPrecision: 2,\r\n\r\n\tsequencePoses: [],\r\n\tsequenceSeekPos: 0,\r\n\tsequenceEditFrame: undefined,\r\n})\r\nexport const MainContext=createContext(JSON.parse(initState))\r\nexport const current={} // state,dispatch\r\nexport const urlStateParamList=['IP','isPolling']\r\n\r\nlet mounted=false\r\nexport default withRouter(function MainContextProvider({children,location,history}){\r\n\tlet state\r\n\t([state,dispatch]=useReducer(mainReducer,JSON.parse(initState)))\r\n\r\n\tuseEffect(componentDidMount,[])\r\n\tuseEffect(stateToUrl,[...urlStateParamList.map(p=>state[p]),location.pathname])\r\n\tuseEffect(onSetIP,[state.IP])\r\n\r\n\t// console.log('MainContextProvider render')\r\n\treturn <MainContext.Provider value={{state,dispatch}}>{children}</MainContext.Provider>\r\n\r\n\tfunction componentDidMount(){\r\n\t\tconsole.log('componentDidMount')\r\n\t\tconst stateFromUrl=_.pick(Object.fromEntries(new URLSearchParams(location.search)),urlStateParamList)\r\n\t\tdispatch(['SET_STATE',stateFromUrl])\r\n\t\twindow.setInterval(()=>{\r\n\t\t\tif(currentState.isPolling){\r\n\t\t\t\t// console.log(currentState)\r\n\t\t\t\taxios.get(`https://${currentState.IP}:7878/live`).then(res=>{\r\n\t\t\t\t\t// console.log(res.data)\r\n\t\t\t\t\t// dispatch(['SET_ACTUAL_ANGLES',res.data])\r\n\t\t\t\t\trealPose={...JSON.parse(homePose),...res.data.position}\r\n\t\t\t\t\ttargetPose={...JSON.parse(homePose),...res.data.target}\r\n\t\t\t\t\tdispatch(['SET_STATE',{online: true}])\r\n\t\t\t\t}).catch(err=>dispatch(['SET_STATE',{online: false}]))\r\n\t\t\t}\r\n\t\t},1000)\r\n\t}\r\n\r\n\tfunction stateToUrl(){\r\n\t\tconsole.log('stateToUrl')\r\n\t\tif(mounted)\r\n\t\t\thistory.replace(location.pathname+'?'+new URLSearchParams(_.pick(state,urlStateParamList)).toString())\r\n\t\telse{\r\n\t\t\thistory.replace('/?'+new URLSearchParams(_.pick(state,urlStateParamList)).toString())\r\n\t\t\tmounted=true\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO: Robot nickname, firmware versions\r\n\tfunction onSetIP(){\r\n\t\tdispatch(['SET_STATE',{camFeedState: 'searching'}])\r\n\t}\r\n})\r\n","import React,{useContext,Fragment,useState} from 'react'\r\nimport axios from 'axios'\r\nimport {Scrollbar} from 'react-scrollbars-custom'\r\n\r\nimport './RightSidebar.scss'\r\nimport {MainContext,homePose,targetPose,realPose} from '../../contexts/MainContext'\r\nimport Sixi2,{Sixi2Speeds} from '../../model/Sixi2'\r\nimport Accordion from '../../utilities/Accordion/Accordion'\r\n\r\n// TODO: End Affector Status\r\n// TODO: Speed & accl\r\n// TODO: Disable sidebar if historySeekPos!==poseHistory\r\n\r\nlet state,dispatch\r\nexport default function RightSidebar(){\r\n\t({state,dispatch}=useContext(MainContext))\r\n\treturn (\r\n\t\t<Scrollbar id=\"RightSidebar\" disableTracksWidthCompensation>\r\n\t\t\t<div className=\"row f-vert f-nowrap\" style={{height: '100vh'}}>\r\n\t\t\t\t{/*<div className=\"b-600 p-12\">Sim Robot Controls</div>*/}\r\n\t\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t\t<Accordion head={'Arm Angles'}>\r\n\t\t\t\t\t\t{['x','y','z'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t\t</Accordion>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t\t<Accordion head={'Wrist Angles'}>\r\n\t\t\t\t\t\t{['u','v','w'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t\t</Accordion>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t\t<Accordion head={'Hand State'}>\r\n\t\t\t\t\t\t{['t'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t\t</Accordion>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col-extrude row spc-12\">\r\n\t\t\t\t\t<div className=\"button-icon col-12\" onClick={()=>dispatch(['SET_SIM_ANGLES',JSON.parse(homePose)])}>\r\n\t\t\t\t\t\t<div className=\"icon icon-home text-muted\"/>\r\n\t\t\t\t\t\t<div className=\"col\">Load Home Pose</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"button-icon col-12\" onClick={()=>dispatch(['SET_SIM_ANGLES',realPose])}>\r\n\t\t\t\t\t\t<div className=\"icon icon-joystick text-muted\"/>\r\n\t\t\t\t\t\t<div className=\"col\">Load Real World Pose</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"button-icon col-12\" onClick={()=>dispatch(['SET_SIM_ANGLES',targetPose])}>\r\n\t\t\t\t\t\t<div className=\"icon icon-node_link_direction text-muted\"/>\r\n\t\t\t\t\t\t<div className=\"col\">Load Target Pose</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\tclassName=\"button-icon col-6\"\r\n\t\t\t\t\t\thref={`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(state.simPose))}`}\r\n\t\t\t\t\t\tdownload=\"pose.json\">\r\n\t\t\t\t\t\t<div className=\"icon icon-arrow_big_down text-muted\"/>\r\n\t\t\t\t\t\t<div className=\"col\">Save</div>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<div className=\"button-icon col-6\">\r\n\t\t\t\t\t\t<div className=\"icon icon-arrow_big_up text-muted\"/>\r\n\t\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t\t<label htmlFor=\"pose-load\">Load</label>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\t\tid=\"pose-load\"\r\n\t\t\t\t\t\t\t\taccept=\"application/json\"\r\n\t\t\t\t\t\t\t\thidden\r\n\t\t\t\t\t\t\t\tonChange={onUpload}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"accordion-container mt-m10\">\r\n\t\t\t\t\t<Accordion head={'Speed'}>\r\n\t\t\t\t\t\t<SpeedControls/>\r\n\t\t\t\t\t</Accordion>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"f-grow-1\"></div>\r\n\t\t\t\t{/* TODO: Halt*/}\r\n\t\t\t\t<div className=\"col-extrude row spc-12 f-vert\">\r\n\t\t\t\t\t{/*<div className=\"col-extrude row spc-12 f-center\">*/}\r\n\t\t\t\t\t\t{/*<input type=\"checkbox\" checked={state.isPolling} onChange={({target})=>dispatch(['SET_STATE',{isPolling: target.checked}])}/>*/}\r\n\t\t\t\t\t\t{/*<div>Show live position</div>*/}\r\n\t\t\t\t\t\t{/*<div className=\"h7 ml-auto mt-12\">{state.isPolling?(state.online?'Online':'Offline'):undefined}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"button outline row f-center\" onClick={()=>axios.put(`https://${state.IP}:7878/stop`)}>\r\n\t\t\t\t\t\t<div className=\"icon-stop super-center\" style={{fontSize: '11px'}}/>\r\n\t\t\t\t\t\t<div className=\"col text-center\">Emergency Stop</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"button outline row f-center\" onClick={()=>dispatch(['GO'])}>\r\n\t\t\t\t\t\t<div className=\"icon-play super-center\"/>\r\n\t\t\t\t\t\t<div className=\"col text-center\">Go</div>\r\n\t\t\t\t\t</div>*/}\r\n\t\t\t\t\t{/*\r\n\t\t\t\t\t\tstate.showSequenceControl?\r\n\t\t\t\t\t\t\t<div className=\"button outline row f-center\">\r\n\t\t\t\t\t\t\t\t<div className=\"fa fa-forward super-center\"/>\r\n\t\t\t\t\t\t\t\t<div className=\"col text-center\">Play Sequence</div>\r\n\t\t\t\t\t\t\t</div>:undefined\r\n\t\t\t\t\t*/}\r\n\t\t\t\t\t{state.isPolling?<div className={'status h7 ml-auto mb-0 mr-12 '+(state.online?'online':'offline')}/>:undefined}\r\n\t\t\t\t\t<div className=\"controls\">\r\n\t\t\t\t\t\t{/*<div className=\"h7\">{state.isPolling?(state.online?'Online':'Offline'):undefined}</div>*/}\r\n\t\t\t\t\t\t<div style={{height: '23px'}}/>\r\n\t\t\t\t\t\t<div className=\"go\" onClick={()=>dispatch(['GO'])}>Go</div>\r\n\t\t\t\t\t\t<div className=\"button-icon\" onClick={()=>axios.put(`https://${state.IP}:7878/stop`)}>\r\n\t\t\t\t\t\t\t<div className=\"icon icon-stop\" style={{fontSize: '11px'}}/>\r\n\t\t\t\t\t\t\t<div className=\"f-grow-1\">Stop</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{state.showSequenceControl?\r\n\t\t\t\t\t\t<div className=\"button-icon\" onClick={()=>axios.put(`https://${state.IP}:7878/batch`,state.sequencePoses.map(v=>JSON.parse(v)))}>\r\n\t\t\t\t\t\t\t<div className=\"fa fa-forward text-muted\" style={{transform: 'scaleY(.75)'}}/>\r\n\t\t\t\t\t\t\t<div className=\"col\">Play Sequence</div>\r\n\t\t\t\t\t\t</div>:undefined}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Scrollbar>\r\n\t)\r\n\r\n\tfunction onUpload({target}){\r\n\t\tconst reader=new FileReader()\r\n\t\treader.onload=({target})=>dispatch(['SET_SIM_ANGLES',JSON.parse(target.result)])\r\n    reader.readAsText(target.files[0])\r\n\t}\r\n}\r\n\r\nfunction SectionInput({i}){\r\n\tconst section=Sixi2[i]\r\n\tconst [resetActive,setResetActive]=useState(false)\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div className=\"px-8 pt-2 row mt-0\"px-8 >\r\n\t\t\t\t<label className=\"uppercase\">{i}</label>\r\n\t\t\t\t<div className=\"col\" style={{height: '30px'}}>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\tmin={section.angles.min}\r\n\t\t\t\t\t\tmax={section.angles.max}\r\n\t\t\t\t\t\tvalue={+state.simPose[i].toFixed(1)}\r\n\t\t\t\t\t\t{...{onChange}}\r\n\t\t\t\t\t\tstep=\".1\"/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"px-8 pb-8 row\">\r\n\t\t\t\t<div className=\"button outline fa fa-repeat p-0 text-muted\" title=\"Reset\" onClick={()=>setResetActive(!resetActive)}/>\r\n\t\t\t\t<div className=\"pl-10 col row f-justify-space-between\">\r\n\t\t\t\t\t<div className=\"col text-muted h7\">{+section.angles.min.toFixed(1)}</div>\r\n\t\t\t\t\t{/*<div className=\"col text-center b-500\">{state.simPose[i]}°</div>*/}\r\n\t\t\t\t\t{/*<input className=\"text-center py-2\" type=\"number\" pattern=\"-?[0-9]+(\\.[0-9]{0,3})?\" value={state.simPose[i]} {...{onChange}}/>*/}\r\n\t\t\t\t\t<div className=\"button-icon f-self-center\" style={{height: '20px'}}>\r\n\t\t\t\t\t\t<div className=\"icon h7 text-muted\" style={{fontFamily: 'inherit'}}>{+section.angles.home.toFixed(1)}</div>\r\n\t\t\t\t\t\t<div className=\"p-0\">\r\n\t\t\t\t\t\t\t<input className=\"text-center py-2\" type=\"number\" value={+state.simPose[i].toFixed(1)} {...{onChange}}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col text-muted h7 text-right\">{+section.angles.max.toFixed(1)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className={'popover-container mt-m4'+(resetActive?'':' hide')}>\r\n\t\t\t\t\t<div className=\"popover-tl\">\r\n\t\t\t\t\t\t<div className=\"row f-center p-8\">\r\n\t\t\t\t\t\t\t{/*<div className=\"button outline icon-cross_mark\" onClick={()=>setResetActive(false)}/>*/}\r\n\t\t\t\t\t\t\t<div className=\"mr-auto ml-8\">Reset to:</div>\r\n\t\t\t\t\t\t\t<button title=\"Home angle\" className=\"outline ml-8 h8 icon-home\" style={{height: '22px'}} onClick={()=>onClick(JSON.parse(homePose)[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t\t\t<button title=\"Actual angle\" className=\"outline ml-8 h8 icon-joystick\" style={{height: '22px'}} onClick={()=>onClick(realPose[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t\t\t<button title=\"Target angle\" className=\"outline ml-8 h8 icon-node_link_direction\" style={{height: '22px'}} onClick={()=>onClick(targetPose[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction onClick(pose){\r\n\t\tsetResetActive(false)\r\n\t\tonChange({target:{valueAsNumber:pose}})\r\n\t}\r\n\r\n\tfunction onChange({target:{valueAsNumber}}){\r\n\t\tdispatch(['SET_SIM_ANGLES',{...state.simPose,[i]: valueAsNumber}])\r\n\t}\r\n}\r\n\r\nfunction SpeedControls(){\r\n\tconst [state,setState]=useState({\r\n\t\tvelocity: Sixi2Speeds.velocity.default,\r\n\t\tacceleration: Sixi2Speeds.acceleration.default,\r\n\t})\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<div className=\"p-8\">\r\n\t\t\t\t<div className=\"h7 text-muted\">Angular Velocity</div>\r\n\t\t\t\t<div className=\"row mt-0\">\r\n\t\t\t\t\t<div className=\"col\" style={{height: '30px'}}>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\tmin={Sixi2Speeds.velocity.min}\r\n\t\t\t\t\t\t\tmax={Sixi2Speeds.velocity.max}\r\n\t\t\t\t\t\t\tvalue={+state.velocity.toFixed(1)}\r\n\t\t\t\t\t\t\t{...{onChange}}\r\n\t\t\t\t\t\t\tstep=\".1\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col row f-justify-space-between\" style={{height: '22px'}}>\r\n\t\t\t\t\t\t<div className=\"col text-muted h7\">{+Sixi2Speeds.velocity.min.toFixed(1)}</div>\r\n\t\t\t\t\t\t{/*<div className=\"col text-center b-500\">{state.simPose[i]}°</div>*/}\r\n\t\t\t\t\t\t{/*<input className=\"text-center py-2\" type=\"number\" pattern=\"-?[0-9]+(\\.[0-9]{0,3})?\" value={state.simPose[i]} {...{onChange}}/>*/}\r\n\t\t\t\t\t\t<div className=\"button-icon f-self-center\" style={{height: '20px'}}>\r\n\t\t\t\t\t\t\t<div className=\"icon h7 text-muted\" style={{fontFamily: 'inherit'}}>{Sixi2Speeds.velocity.default}</div>\r\n\t\t\t\t\t\t\t<div className=\"p-0\">\r\n\t\t\t\t\t\t\t\t<input className=\"text-center py-2\" type=\"number\" value={+state.velocity.toFixed(1)} {...{onChange}}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"col text-muted h7 text-right\">{+Sixi2Speeds.velocity.max.toFixed(1)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"p-8\">\r\n\t\t\t\t<div className=\"h7 text-muted\">Angular Acceleration</div>\r\n\t\t\t\t<div className=\"row mt-0\">\r\n\t\t\t\t\t<div className=\"col\" style={{height: '30px'}}>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\tmin={Sixi2Speeds.acceleration.min}\r\n\t\t\t\t\t\t\tmax={Sixi2Speeds.acceleration.max}\r\n\t\t\t\t\t\t\tvalue={+state.acceleration.toFixed(1)}\r\n\t\t\t\t\t\t\t{...{onChange}}\r\n\t\t\t\t\t\t\tstep=\".1\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col row f-justify-space-between\" style={{height: '22px'}}>\r\n\t\t\t\t\t\t<div className=\"col text-muted h7\">{+Sixi2Speeds.acceleration.min.toFixed(1)}</div>\r\n\t\t\t\t\t\t{/*<div className=\"col text-center b-500\">{state.simPose[i]}°</div>*/}\r\n\t\t\t\t\t\t{/*<input className=\"text-center py-2\" type=\"number\" pattern=\"-?[0-9]+(\\.[0-9]{0,3})?\" value={state.simPose[i]} {...{onChange}}/>*/}\r\n\t\t\t\t\t\t<div className=\"button-icon f-self-center\" style={{height: '20px'}}>\r\n\t\t\t\t\t\t\t<div className=\"icon h7 text-muted\" style={{fontFamily: 'inherit'}}>{Sixi2Speeds.acceleration.default}</div>\r\n\t\t\t\t\t\t\t<div className=\"p-0\">\r\n\t\t\t\t\t\t\t\t<input className=\"text-center py-2\" type=\"number\" value={+state.acceleration.toFixed(1)} {...{onChange}}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"col text-muted h7 text-right\">{+Sixi2Speeds.acceleration.max.toFixed(1)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t)\r\n\r\n\tfunction onChange({target:{valueAsNumber}}){\r\n\r\n\t}\r\n}\r\n","import React,{useContext,useState,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nimport './Login.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default withRouter(function Login({history}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst [isMounted,setIsMounted]=useState(false)\r\n\r\n\tuseEffect(()=>setIsMounted(true),[])\r\n\r\n\t// console.log('Login render')\r\n\treturn (\r\n\t\t<form id=\"Login\" className={isMounted?'active':undefined} {...{onSubmit}}>\r\n\t\t\t<section>\r\n\t\t\t\t{isMounted?<style>\r\n\t\t\t\t\t#cam-feed,\r\n\t\t\t\t\t#cam-feed:hover:not(.active)&#123;\r\n\t\t\t\t\t\tz-index: 1;\r\n\t\t\t\t\t\ttransform: scale(1,1);\r\n\t\t\t\t\t\tright: calc(50% - 320px);\r\n\t\t\t\t\t\tbottom: calc(50% - 213px);\r\n\t\t\t\t\t\tborder-radius: 6px;\r\n\t\t\t\t\t\ttransition: opacity .5s;\r\n\t\t\t\t\t&#125;\r\n\t\t\t\t</style>:undefined}\r\n\t\t\t\t<div className=\"cam-feed-container\"/>\r\n\t\t\t\t<div className=\"row spc-12 f-center\">\r\n\t\t\t\t\t<label htmlFor=\"login-ip\">Robot Address / IP</label>\r\n\t\t\t\t\t<div className=\"button outline text-muted\" style={{borderRadius: '4px 0 0 4px',cursor: 'initial'}}>https://</div>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tid=\"login-ip\"\r\n\t\t\t\t\t\tclassName=\"col col-extrude-l\"\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"Robot IP\"\r\n\t\t\t\t\t\tvalue={state.IP}\r\n\t\t\t\t\t\tonChange={({target})=>dispatch(['SET_STATE',{IP: target.value}])}/>\r\n\t\t\t\t\t<button className=\"outline\">Go</button>\r\n\t\t\t\t</div>\r\n\t\t\t</section>\r\n\t\t</form>\r\n\t)\r\n\r\n\tfunction onSubmit(e){\r\n\t\te.preventDefault()\r\n\t\tsetIsMounted(false)\r\n\t\twindow.setTimeout(()=>history.push('/'),500)\r\n\t}\r\n})\r\n","import React,{useContext,useState,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nimport './Settings.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default withRouter(function Settings({history}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst [isMounted,setIsMounted]=useState(false)\r\n\r\n\tuseEffect(()=>setIsMounted(true),[])\r\n\r\n\t// console.log('Settings render')\r\n\treturn (\r\n\t\t<div id=\"Settings\" className={isMounted?'active':undefined}>\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction onSubmit(e){\r\n\t\te.preventDefault()\r\n\t\tsetIsMounted(false)\r\n\t\twindow.setTimeout(()=>history.push('/'),500)\r\n\t}\r\n})\r\n","import React,{Fragment,useState} from 'react'\r\nimport './Accordion.css'\r\n\r\n// TODO: headProps,bodyProps,bodyInnerProps\r\nexport default function Accordion(props){\r\n\tconst [state,setState]=useState({expanded: true,maxHeight: undefined})\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<div\r\n\t\t\t\tid={props.id}\r\n\t\t\t\tclassName={'accordion'+(props.className ?? '')+(state.expanded?' expanded':'')}\r\n\t\t\t\t{...{onClick}}\r\n\t\t\t>{props.head}</div>\r\n\t\t\t<div style={{maxHeight: state.maxHeight}}>\r\n\t\t\t\t<div>{props.children}</div>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t)\r\n\r\n\tfunction onClick({currentTarget}){\r\n\t\tconst maxHeight=currentTarget.nextSibling.children[0].offsetHeight\r\n\t\tcurrentTarget.nextSibling.style.maxHeight=maxHeight+'px'\r\n\t\t// setExpanded(!expanded)\r\n\t\tsetTimeout(()=>setState({expanded: !state.expanded,maxHeight}),0)\r\n\t}\r\n}\r\n","import React,{useContext} from 'react'\r\n\r\nimport './BottomDrawer.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport HistoryTimeline from '../HistoryTimeline/HistoryTimeline'\r\nimport SequenceControls from '../SequenceControls/SequenceControls'\r\n\r\nexport default function BottomDrawer(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {showHistoryTimeline,showSequenceControl,showLibrary}=state\r\n\r\n\treturn (\r\n\t\t<div id=\"BottomDrawer\">\r\n\t\t\t<style>:root&#123; --bottomDrawerHeight: {(+showHistoryTimeline+showSequenceControl)*172+46}px &#125;</style>\r\n\t\t\t<div id=\"taskbar\" className=\"row spc-8 f-end\">\r\n\t\t\t\t<div className={'button-icon'+(showHistoryTimeline?' active':'')} onClick={()=>dispatch(['SET_STATE',{showHistoryTimeline: !showHistoryTimeline}])}>\r\n\t\t\t\t\t<div className=\"fa fa-history\"/>\r\n\t\t\t\t\t<div className=\"col\">History Timeline</div>\r\n\t\t\t\t\t<div className=\"fa fa-history\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={'button-icon'+(showSequenceControl?' active':'')} onClick={()=>dispatch(['SET_STATE',{showSequenceControl: !showSequenceControl}])}>\r\n\t\t\t\t\t<div className=\"icon icon-layout_directed\"/>\r\n\t\t\t\t\t<div className=\"col\">Sequence Controls</div>\r\n\t\t\t\t\t<div className=\"icon icon-layout_directed\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={'button-icon'+(showLibrary?' active':'')} onClick={()=>dispatch(['SET_STATE',{showLibrary: !showLibrary}])} hidden> {/* TODO: Unhide */}\r\n\t\t\t\t\t<div className=\"fa fa-bookmark\"/>\r\n\t\t\t\t\t<div className=\"col\">Library</div>\r\n\t\t\t\t\t<div className=\"fa fa-bookmark\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ml-auto h7\">v{process.env.REACT_APP_VERSION}</div>\r\n\t\t\t</div>\r\n\t\t\t{showHistoryTimeline?<HistoryTimeline/>:undefined}\r\n\t\t\t{showSequenceControl?<SequenceControls/>:undefined}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext,Fragment} from 'react'\r\n\r\nimport './CamFeed.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\n// TODO: camFeedState!=='found'\r\nexport default function CamFeed({className,children}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<style>\r\n\t\t\t\t#cam-feed&#123;\r\n\t\t\t\t\t{state.camFeedState!=='found'?'opacity: 0':undefined}\r\n\t\t\t\t&#125;\r\n\t\t\t</style>\r\n\t\t\t<img id=\"cam-feed\"\r\n\t\t\t\tclassName={state.camFeedMaximize?'active':''}\r\n\t\t\t\tsrc={`http://${state.IP}:8081/?action=stream`}\r\n\t\t\t\talt=\"Cam feed\"\r\n\t\t\t\tonClick={()=>dispatch(['SET_STATE',{camFeedMaximize: !state.camFeedMaximize}])}\r\n\t\t\t\tonLoad={()=>dispatch(['SET_STATE',{camFeedState: 'found'}])}\r\n\t\t\t\tonError={()=>dispatch(['SET_STATE',{camFeedState: 'not found'}])}\r\n\t\t\t/>\r\n\t\t</Fragment>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport './Header.scss'\r\n\r\n// TODO: Robot name\r\nexport default function Header(){\r\n\treturn (\r\n\t\t<header id=\"Header\" className=\"row spc-8 spc-x-16 f-center\">\r\n\t\t\t<img src={require('../../assets/imgs/icon_logo.svg')} alt=\"\"/>\r\n\t\t\t<div className=\"b-600 uppercase\">\r\n\t\t\t\t<div className=\"h8 text-muted\">Marginally Clever</div>\r\n\t\t\t\t<div className=\"h5\">Robot Overlord Studio {/*<sup><span className=\"h7 gradient-text b-900 normalcase\">v{process.env.REACT_APP_VERSION}</span></sup>*/}</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<Link to=\"/login\" className=\"button-icon\">\r\n\t\t\t\t<div className=\"fa fa-power-off text-muted\"/>\r\n\t\t\t\t<div>Login</div>\r\n\t\t\t</Link>\r\n\t\t\t<Link to=\"/settings\" className=\"button-icon\" hidden> {/* TODO: Unhide */}\r\n\t\t\t\t<div className=\"fa fa-cogs text-muted\"/>\r\n\t\t\t\t<div>Settings</div>\r\n\t\t\t</Link>\r\n\t\t\t<div className=\"button-icon\" onClick={()=>window.location.reload()}>\r\n\t\t\t\t<div className=\"fa fa-refresh text-muted\"/>\r\n\t\t\t\t<div>Reload</div>\r\n\t\t\t</div>\r\n\t\t</header>\r\n\t)\r\n}\r\n","import React,{/*useContext*/} from 'react'\nimport {Route,withRouter,/*Link*/} from 'react-router-dom'\n\nimport './App.scss'\nimport Login from '../Login/Login'\nimport Settings from '../Settings/Settings'\n// import {MainContext} from '../../contexts/MainContext'\n// import RobotView from '../RobotView/RobotView'\nimport SimRobot from '../SimRobot/SimRobot'\nimport RightSidebar from '../RightSidebar/RightSidebar'\nimport BottomDrawer from '../BottomDrawer/BottomDrawer'\nimport CamFeed from '../CamFeed/CamFeed'\nimport Header from '../Header/Header'\n\nexport default withRouter(function App(){\n\t// const {state,dispatch}=useContext(MainContext)\n\n\t// console.log('App render')\n\treturn (\n\t\t<div id=\"App\">\n\t\t\t{/*<RobotView/>*/}\n\t\t\t<div className=\"pos-rel\">\n\t\t\t\t<SimRobot/>\n\t\t\t\t<Header/>\n\t\t\t</div>\n\t\t\t<RightSidebar/>\n\t\t\t<CamFeed/>\n\t\t\t<BottomDrawer/>\n\t\t\t<Route path=\"/login\" component={Login}/>\n\t\t\t<Route path=\"/settings\" component={Settings}/>\n\t\t</div>\n\t)\n})\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {HashRouter} from 'react-router-dom'\n\nimport './index.scss'\nimport App from './components/App/App'\nimport * as serviceWorker from './serviceWorker'\nimport MainContextProvider from './contexts/MainContext'\n\n// TODO: Pose class\n\nReactDOM.render(\n\t// <React.StrictMode>\n\t\t<HashRouter>\n\t\t\t<MainContextProvider>\n\t\t\t\t<App/>\n\t\t\t</MainContextProvider>\n\t\t</HashRouter>\n\t// </React.StrictMode>\n\t,document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n","module.exports = __webpack_public_path__ + \"static/media/d2drhlh-0c1dc8e8-310b-4f13-b1ed-596c78153401-gray.dc7a7340.jpg\";","var map = {\n\t\"./1_Anchor.obj\": 85,\n\t\"./2_Shoulder.obj\": 86,\n\t\"./3_Bicep.obj\": 87,\n\t\"./4_Forearm.obj\": 88,\n\t\"./5_TuningFork.obj\": 89,\n\t\"./6_PicassoBox.obj\": 90,\n\t\"./7_Hand.obj\": 91,\n\t\"./8_ClampBase.obj\": 92,\n\t\"./9_Clamp_Left_Fixed.obj\": 93,\n\t\"./9_Clamp_Right_Fixed.obj\": 94\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 84;","module.exports = __webpack_public_path__ + \"static/media/1_Anchor.05a3563c.obj\";","module.exports = __webpack_public_path__ + \"static/media/2_Shoulder.67fa005d.obj\";","module.exports = __webpack_public_path__ + \"static/media/3_Bicep.6eb28d2f.obj\";","module.exports = __webpack_public_path__ + \"static/media/4_Forearm.bab2fed0.obj\";","module.exports = __webpack_public_path__ + \"static/media/5_TuningFork.69d3d423.obj\";","module.exports = __webpack_public_path__ + \"static/media/6_PicassoBox.78e539c9.obj\";","module.exports = __webpack_public_path__ + \"static/media/7_Hand.bfb064cf.obj\";","module.exports = __webpack_public_path__ + \"static/media/8_ClampBase.659054d7.obj\";","module.exports = __webpack_public_path__ + \"static/media/9_Clamp_Left_Fixed.45fe70fc.obj\";","module.exports = __webpack_public_path__ + \"static/media/9_Clamp_Right_Fixed.1e1f6339.obj\";"],"sourceRoot":""}
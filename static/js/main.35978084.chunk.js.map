{"version":3,"sources":["model/Sixi2.js","assets/objs sync /^/.*$","assets/objs/1_Anchor.obj","assets/objs/2_Shoulder.obj","assets/objs/3_Bicep.obj","assets/objs/4_Forearm.obj","assets/objs/5_TuningFork.obj","assets/objs/6_PicassoBox.obj","assets/objs/7_Hand.obj","assets/objs/8_ClampBase.obj","assets/objs/9_Clamp_Left_Fixed.obj","assets/objs/9_Clamp_Right_Fixed.obj","assets/imgs/icon_logo.svg","three-js-helper.js","components/PoseToImg/PoseToImg.js","components/SimRobot/SimRobot.js","utilities/SegmentControls/SegmentControls.js","components/HistoryTimeline/HistoryTimeline.js","reducers/mainReducer.js","contexts/MainContext.js","components/RightSidebar/RightSidebar.js","components/Login/Login.js","utilities/Accordion/Accordion.js","components/SequenceControls/SequenceControls.js","components/BottomDrawer/BottomDrawer.js","components/CamFeed/CamFeed.js","components/Header/Header.js","components/App/App.js","serviceWorker.js","index.js"],"names":["module","exports","x","position","axis","angles","home","min","max","objs","y","parent","z","u","v","w","t","t_l","t_r","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","objLoader","OBJLoader","setupRenderer","width","height","renderer","camera","aspectRatio","setSize","setPixelRatio","window","devicePixelRatio","fov","Math","atan","THREE","DEG2RAD","aspect","updateProjectionMatrix","scene","antialias","alpha","preserveDrawingBuffer","canvas","domElement","document","body","appendChild","section3dObjects","set","lookAt","imgCache","PoseToImg","pose","cache","props","state","useContext","MainContext","thumbnail","isPoseToImgReady","poseObj","JSON","parse","_","forIn","s","i","rotateSection","render","toDataURL","src","data-pose","alt","controls","SegmentControls","onChange","value","Number","isInteger","className","style","transform","children","length","c","key","childProps","onClick","index","endAffector3dObject","endAffectorControls","section3dObjs","objNames","values","Sixi2","flatMap","filter","objLoadPromise","Promise","all","path","require","reject","load","then","forEach","SimRobot","useRef","useEffect","a","current","OrbitControls","enableDamping","enablePan","dampingFactor","rotateSpeed","maxPolarAngle","PI","target","setupThisRenderer","addEventListener","pointLight","add","ambientLight","intensity","clone","so","mapValues","postObjLoad","console","log","dispatch","TransformControls","enabled","setSpace","attach","updateMatrixWorld","pos","getWorldPosition","toArray","yPos","yLen","zuLen","addVectors","eaFromY","subVectors","eaLen","yzInitAngle","angleFromSSSTriangle","RAD2DEG","xAngle","eaXZ","setY","beta","zAngle","currentState","simPose","useState","endAffectorMode","setEndEffectorMode","ref","object","setMode","offsetWidth","offsetHeight","data","name","sectionOuter","setRotationFromAxisAngle","sectionInner","sectionName","inner","angle","clamp","sectionAngle","datatTo3dObject","section","leftFork","rightFork","offset","factor","requestAnimationFrame","update","b","acos","currentPose","HistoryTimeline","historySeekPos","poseHistory","historyLockHand","historySeekbarPrecision","stringify","type","checked","visibility","round","valueAsNumber","showHistoryTimeline","step","undefined","p","prevPose","prevBottomExpanded","mainReducer","actionType","reducer","toFixed","simScene","online","axios","put","IP","push","isNaN","floor","ceil","lerp","poseLerp","isPolling","showSequenceControl","setTimeout","simRobotResize","homePose","sections","realPose","targetPose","initState","camFeedState","camFeedMaximize","showLibrary","createContext","urlStateParamList","mounted","withRouter","location","history","useReducer","stateFromUrl","pick","fromEntries","URLSearchParams","search","setInterval","get","res","catch","err","replace","pathname","toString","Provider","isMounted","setIsMounted","onSubmit","preventDefault","htmlFor","borderRadius","cursor","Accordion","expanded","maxHeight","setState","currentTarget","nextSibling","head","RightSidebar","SectionInput","fontSize","resetActive","setResetActive","title","tabIndex","SequenceControls","BottomDrawer","CamFeed","onLoad","onError","Header","to","reload","component","Login","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","error","ReactDOM","getElementById","URL","process","href","origin","fetch","headers","response","contentType","status","indexOf","ready","unregister","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.35978084.chunk.js","sourcesContent":["// axis: axis of rotation\r\n// angles.home angle (deg)\r\n// angles.min  angle (deg)\r\n// angles.max  angle (deg)\r\n\r\nmodule.exports={\r\n\tx: {\r\n\t\tposition: [0,11.32,0],\r\n\t\taxis: [0,-1,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -120,\r\n\t\t\tmax: 120,\r\n\t\t},\r\n\t\tobjs: ['2_Shoulder.obj'],\r\n\t},\r\n\ty: {\r\n\t\tposition: [0,7.524,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: -90,\r\n\t\t\tmin: -170,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['3_Bicep.obj'],\r\n\t\tparent: 'x',\r\n\t},\r\n\tz: {\r\n\t\tposition: [0,35.796,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -83.369,\r\n\t\t\tmax: 86,\r\n\t\t},\r\n\t\tobjs: ['4_Forearm.obj'],\r\n\t\tparent: 'y',\r\n\t},\r\n\tu: {\r\n\t\tposition: [29.207,6.406,0],\r\n\t\taxis: [-1,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -175,\r\n\t\t\tmax: 175,\r\n\t\t},\r\n\t\tobjs: ['5_TuningFork.obj'],\r\n\t\tparent: 'z',\r\n\t},\r\n\tv: {\r\n\t\tposition: [9.513,0,0],\r\n\t\taxis: [0,0,1],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -120,\r\n\t\t\tmax: 120,\r\n\t\t},\r\n\t\tobjs: ['6_PicassoBox.obj'],\r\n\t\tparent: 'u',\r\n\t},\r\n\tw: {\r\n\t\tposition: [5.423,0,0],\r\n\t\taxis: [-1,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: -170,\r\n\t\t\tmax: 170,\r\n\t\t},\r\n\t\tobjs: ['7_Hand.obj'],\r\n\t\tparent: 'v',\r\n\t},\r\n\tt: {\r\n\t\tposition: [0,0,0],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 180,\r\n\t\t\tmin: 10,\r\n\t\t\tmax: 180,\r\n\t\t},\r\n\t\tobjs: ['8_ClampBase.obj'],\r\n\t\tparent: 'w',\r\n\t},\r\n\tt_l: {\r\n\t\tposition: [10.634,0,-4.05],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['9_Clamp_Left_Fixed.obj'],\r\n\t\tparent: 't',\r\n\t},\r\n\tt_r: {\r\n\t\tposition: [10.634,0,4.05],\r\n\t\taxis: [0,0,0],\r\n\t\tangles: {\r\n\t\t\thome: 0,\r\n\t\t\tmin: 0,\r\n\t\t\tmax: 0,\r\n\t\t},\r\n\t\tobjs: ['9_Clamp_Right_Fixed.obj'],\r\n\t\tparent: 't',\r\n\t},\r\n}\r\n","var map = {\n\t\"./1_Anchor.obj\": 76,\n\t\"./2_Shoulder.obj\": 77,\n\t\"./3_Bicep.obj\": 78,\n\t\"./4_Forearm.obj\": 79,\n\t\"./5_TuningFork.obj\": 80,\n\t\"./6_PicassoBox.obj\": 81,\n\t\"./7_Hand.obj\": 82,\n\t\"./8_ClampBase.obj\": 83,\n\t\"./9_Clamp_Left_Fixed.obj\": 84,\n\t\"./9_Clamp_Right_Fixed.obj\": 85\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 75;","module.exports = __webpack_public_path__ + \"static/media/1_Anchor.05a3563c.obj\";","module.exports = __webpack_public_path__ + \"static/media/2_Shoulder.67fa005d.obj\";","module.exports = __webpack_public_path__ + \"static/media/3_Bicep.6eb28d2f.obj\";","module.exports = __webpack_public_path__ + \"static/media/4_Forearm.bab2fed0.obj\";","module.exports = __webpack_public_path__ + \"static/media/5_TuningFork.69d3d423.obj\";","module.exports = __webpack_public_path__ + \"static/media/6_PicassoBox.78e539c9.obj\";","module.exports = __webpack_public_path__ + \"static/media/7_Hand.bfb064cf.obj\";","module.exports = __webpack_public_path__ + \"static/media/8_ClampBase.659054d7.obj\";","module.exports = __webpack_public_path__ + \"static/media/9_Clamp_Left_Fixed.45fe70fc.obj\";","module.exports = __webpack_public_path__ + \"static/media/9_Clamp_Right_Fixed.1e1f6339.obj\";","module.exports = __webpack_public_path__ + \"static/media/icon_logo.e152c216.svg\";","import * as THREE from 'three'\r\nimport {OBJLoader} from 'three/examples/jsm/loaders/OBJLoader'\r\nexport const objLoader=new OBJLoader()\r\n\r\nexport function objLoaderAsync(path){\r\n\treturn new Promise((resolve,reject)=>{\r\n\t\ttry{ objLoader.load(path,o=>resolve(o),null,null,null) }\r\n\t\tcatch(e){ reject(e) }\r\n\t})\r\n}\r\n\r\n// Returns angle between (-180,180]\r\nexport function normalizeAngle(angle){\r\n\tangle=angle%360\r\n\tangle=(angle+360)%360\r\n\tif(angle>180) angle-=360\r\n\treturn angle\r\n}\r\n\r\nexport function setupRenderer(width,height,renderer,camera){\r\n\tconst aspectRatio=width/height\r\n\r\n\trenderer.setSize(width,height)\r\n\trenderer.setPixelRatio(window.devicePixelRatio)\r\n\t// renderer.setPixelRatio(1) // Low quality, high performance for higher density displays\r\n\r\n\t// Universal desktop and mobile friendly FOV algorithm\r\n\tcamera.fov=45*(aspectRatio>1?1:Math.atan(1/aspectRatio)/THREE.Math.DEG2RAD/45)\r\n\tcamera.aspect=aspectRatio\r\n\tcamera.updateProjectionMatrix()\r\n}\r\n","import React,{useContext} from 'react'\r\nimport * as THREE from 'three'\r\n// import {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport _ from 'lodash'\r\n\r\nimport './PoseToImg.scss'\r\nimport {postObjLoad} from '../SimRobot/SimRobot'\r\nimport {MainContext,dispatch} from '../../contexts/MainContext'\r\nimport {setupRenderer} from '../../three-js-helper'\r\n\r\n// NOTE: Maybe blobs (about 20% better memory efficiency)\r\n\r\nconst renderer=new THREE.WebGLRenderer({\r\n\tantialias:             true,\r\n\talpha:                 true,\r\n\tpreserveDrawingBuffer: true,\r\n})\r\nconst canvas=renderer.domElement\r\ncanvas.id='PoseToImgCanvas'\r\ndocument.body.appendChild(canvas)\r\n\r\nlet scene\r\nlet section3dObjs={}\r\nconst section3dObjects={}\r\n\r\nconst camera=new THREE.PerspectiveCamera()\r\ncamera.position.set(100,100,100)\r\ncamera.lookAt(0,30,0)\r\n// const controls=new OrbitControls(camera,canvas)\r\n// controls.enableDamping=true\r\n// controls.enablePan=false\r\n// controls.dampingFactor=.1\r\n// controls.rotateSpeed=.5\r\n// controls.maxPolarAngle=Math.PI/2\r\n// controls.target.set(0,30,0)\r\nsetupRenderer(320,240,renderer,camera)\r\n\r\nfunction render(){\r\n\t// requestAnimationFrame(render)\r\n\t// controls.update()\r\n\trenderer.render(scene,camera)\r\n}\r\n\r\nexport function initPoseToImg(s,so){\r\n\tscene=s\r\n\tsection3dObjs=so\r\n\t// console.log(scene,section3dObjs)\r\n\r\n\tpostObjLoad(scene,section3dObjs,section3dObjects)\r\n\tconsole.log('PoseToImgReady')\r\n\tdispatch(['SET_STATE',{isPoseToImgReady:true}])\r\n}\r\n\r\nconst imgCache=/*JSON.parse(localStorage.getItem('imgCache')) ??*/ {}\r\nexport default function PoseToImg({pose,cache,...props}){\r\n\tconst {state}=useContext(MainContext)\r\n\tlet thumbnail=imgCache[pose]\r\n\r\n\tif(state.isPoseToImgReady && !thumbnail){\r\n\t\tconst poseObj=JSON.parse(pose)\r\n\t\t_.forIn(section3dObjects,(s,i)=>s.rotateSection(poseObj[i]))\r\n\t\trender()\r\n\t\tthumbnail=canvas.toDataURL()\r\n\t\tif(cache!==false){\r\n\t\t\timgCache[pose]=thumbnail\r\n\t\t\t// try{ localStorage.setItem('imgCache',JSON.stringify(imgCache)) }catch(e){ console.error(e) }\r\n\t\t}\r\n\t}\r\n\r\n\t// console.log(imgCache)\r\n\treturn <img src={thumbnail} {...props} data-pose={pose} alt=\"\"/>\r\n}\r\n","import React,{useRef,useEffect,Fragment,useState} from 'react'\r\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport {TransformControls} from 'three/examples/jsm/controls/TransformControls'\r\nimport * as THREE from 'three'\r\nimport _ from 'lodash'\r\n\r\nimport './SimRobot.scss'\r\nimport Sixi2 from '../../model/Sixi2'\r\nimport {initPoseToImg} from '../PoseToImg/PoseToImg'\r\nimport {objLoaderAsync,setupRenderer} from '../../three-js-helper'\r\nimport SegmentControls from '../../utilities/SegmentControls/SegmentControls'\r\nimport {currentState} from '../../reducers/mainReducer'\r\nimport {dispatch} from '../../contexts/MainContext'\r\n\r\nexport let canvas\r\nexport let renderer\r\nexport let scene\r\nexport let camera\r\nexport let controls\r\nexport const section3dObjs={}\r\nexport const section3dObjects={}\r\nexport let cameraPos=new THREE.Vector3(90,90,-90)\r\nexport let endAffector3dObject\r\nexport let endAffectorControls\r\n\r\nexport const objNames=['1_Anchor.obj',...Object.values(Sixi2).flatMap(o=>o.objs)].filter(o=>o)\r\nexport const objLoadPromise=Promise.all(objNames.map(o=>objLoaderAsync(require('../../assets/objs/'+o)))).then(o=>{\r\n\to.forEach((o,i)=>section3dObjs[objNames[i]]=o)\r\n})\r\n\r\nexport default function SimRobot(){\r\n\tcanvas=useRef()\r\n\tuseEffect(componentDidMount,[])\r\n\tconst [endAffectorMode,setEndEffectorMode]=useState(0)\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<canvas id=\"SimRobot\" ref={canvas}></canvas>\r\n\t\t\t<div id=\"IKControls\" className=\"row spc-12\">\r\n\t\t\t\t<div className=\"my-0 ml-0 button-icon\" onClick={()=>controls.object.position.set(100,100,100)}>\r\n\t\t\t\t\t<div className=\"fa fa-repeat text-muted\" style={{transform: 'rotateY(180deg)'}}/>\r\n\t\t\t\t\t<div>Reset View</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<div className=\"h7\">End Affector Control Mode</div>\r\n\t\t\t\t<SegmentControls\r\n\t\t\t\t\tclassName=\"m-2\"\r\n\t\t\t\t\tstyle={{width: '100px'}}\r\n\t\t\t\t\tvalue={endAffectorMode}\r\n\t\t\t\t\tonChange={changeEndEffectorMode}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Fragment>Move</Fragment>\r\n\t\t\t\t\t<Fragment>Rotate</Fragment>\r\n\t\t\t\t</SegmentControls>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t)\r\n\r\n\tfunction componentDidMount(){\r\n\t\t(async ()=>{\r\n\t\t\trenderer=new THREE.WebGLRenderer({\r\n\t\t\t\tantialias:             true,\r\n\t\t\t\tcanvas:                canvas.current,\r\n\t\t\t\talpha:                 true,\r\n\t\t\t\tpreserveDrawingBuffer: true,\r\n\t\t\t})\r\n\t\t\tscene=new THREE.Scene()\r\n\t\t\tcamera=new THREE.PerspectiveCamera()\r\n\t\t\tcamera.position.set(100,100,100)\r\n\t\t\tcamera.lookAt(0,30,0)\r\n\t\t\tcontrols=new OrbitControls(camera,renderer.domElement)\r\n\t\t\tcontrols.enableDamping=true\r\n\t\t\tcontrols.enablePan=false\r\n\t\t\tcontrols.dampingFactor=.1\r\n\t\t\tcontrols.rotateSpeed=.5\r\n\t\t\tcontrols.maxPolarAngle=Math.PI/2\r\n\t\t\tcontrols.target.set(0,30,0)\r\n\t\t\tsetupThisRenderer()\r\n\t\t\twindow.addEventListener('resize',setupThisRenderer,true)\r\n\r\n\t\t\tconst pointLight=new THREE.PointLight()\r\n\t\t\tpointLight.position.set(0,100,0)\r\n\t\t\tscene.add(pointLight)\r\n\t\t\tconst ambientLight=new THREE.AmbientLight()\r\n\t\t\tambientLight.intensity=.25\r\n\t\t\tscene.add(ambientLight)\r\n\r\n\t\t\tawait objLoadPromise\r\n\t\t\t// console.log(scene,section3dObjs)\r\n\t\t\tinitPoseToImg(scene.clone(),_.mapValues(section3dObjs,o=>o.clone()))\r\n\r\n\t\t\tpostObjLoad(scene,section3dObjs,section3dObjects)\r\n\r\n\t\t\tendAffector3dObject=new THREE.Mesh(\r\n\t\t\t\tnew THREE.SphereBufferGeometry(1,32,32),\r\n\t\t\t\tnew THREE.MeshLambertMaterial()\r\n\t\t\t)\r\n\t\t\tscene.add(endAffector3dObject)\r\n\r\n\t\t\tendAffectorControls=new TransformControls(camera,renderer.domElement)\r\n\t\t\tendAffectorControls.addEventListener('dragging-changed',({value})=>controls.enabled=!value)\r\n\t\t\tendAffectorControls.setSpace('local')\r\n\t\t\tendAffectorControls.attach(endAffector3dObject)\r\n\t\t\tscene.add(endAffectorControls)\r\n\r\n\t\t\tscene.updateMatrixWorld()\r\n\t\t\tlet pos=new THREE.Vector3()\r\n\t\t\tsection3dObjects['v'].getWorldPosition(pos)\r\n\t\t\t// section3dObjects['t'].inner.getWorldPosition(pos)\r\n\t\t\t// pos.add(new THREE.Vector3(12.5,1,0))\r\n\t\t\tendAffector3dObject.position.set(...pos.toArray())\r\n\r\n\t\t\t// console.log(section3dObjects['x'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['y'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['z'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['u'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['v'].getWorldPosition())\r\n\t\t\t// console.log(section3dObjects['w'].getWorldPosition())\r\n\r\n\t\t\tconst yPos=new THREE.Vector3()\r\n\t\t\tsection3dObjects['y'].getWorldPosition(yPos)\r\n\t\t\tconst yLen=section3dObjects['z'].position.length()\r\n\t\t\tconst zuLen=new THREE.Vector3().addVectors(section3dObjects['u'].position,section3dObjects['v'].position).length()\r\n\t\t\tconst eaFromY=new THREE.Vector3()\r\n\t\t\teaFromY.subVectors(endAffector3dObject.position,yPos)\r\n\t\t\tconst eaLen=eaFromY.length()\r\n\t\t\tconst yzInitAngle=angleFromSSSTriangle(eaLen,zuLen,yLen)*THREE.Math.RAD2DEG\r\n\r\n\t\t\tendAffectorControls.addEventListener('change',()=>{\r\n\t\t\t\tconst eaFromY=new THREE.Vector3()\r\n\t\t\t\teaFromY.subVectors(endAffector3dObject.position,yPos)\r\n\t\t\t\tconst eaLen=eaFromY.length()\r\n\r\n\t\t\t\tlet xAngle=-Math.atan(eaFromY.z/eaFromY.x)*THREE.Math.RAD2DEG\r\n\t\t\t\tif(eaFromY.x<0)\r\n\t\t\t\t\tif(eaFromY.z>0) xAngle=xAngle-180\r\n\t\t\t\t\telse xAngle=180+xAngle\r\n\r\n\t\t\t\tconst eaXZ=eaFromY.clone().setY(0).length()\r\n\t\t\t\tconst alpha=Math.atan(eaFromY.y/eaXZ)*THREE.Math.RAD2DEG\r\n\t\t\t\tconst beta=angleFromSSSTriangle(zuLen,yLen,eaLen)*THREE.Math.RAD2DEG || 0\r\n\r\n\t\t\t\tconst zAngle=angleFromSSSTriangle(eaLen,zuLen,yLen)*THREE.Math.RAD2DEG || 180\r\n\t\t\t\tdispatch(['SET_SIM_ANGLES',{\r\n\t\t\t\t\t...currentState.simPose,\r\n\t\t\t\t\tx: xAngle,\r\n\t\t\t\t\ty: -alpha-beta,\r\n\t\t\t\t\tz: yzInitAngle-zAngle\r\n\t\t\t\t}])\r\n\t\t\t})\r\n\r\n\t\t\trender()\r\n\t\t})()\r\n\t}\r\n\r\n\tfunction changeEndEffectorMode(i){\r\n\t\tswitch(i){\r\n\t\t\tcase 0:\r\n\t\t\t\tendAffectorControls.setMode('translate')\r\n\t\t\t\tbreak\r\n\t\t\tcase 1:\r\n\t\t\t\tendAffectorControls.setMode('rotate')\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t}\r\n\t\tsetEndEffectorMode(i)\r\n\t}\r\n}\r\n\r\nexport function setupThisRenderer(){\r\n\tsetupRenderer(canvas.current.offsetWidth,canvas.current.offsetHeight,renderer,camera)\r\n}\r\n\r\nexport function postObjLoad(scene,section3dObjs,section3dObjects){\r\n\t_.forIn(Sixi2,(s,i)=>section3dObjects[i]=datatTo3dObject(s,i,section3dObjs,section3dObjects))\r\n\r\n\tconst section=section3dObjects['t'].inner\r\n\tconst leftFork=section.children[1].inner\r\n\tconst rightFork=section.children[2].inner\r\n\tsection3dObjects['t'].rotateSection=function(offset){\r\n\t\t// NOTE: Verify and remove .7\r\n\t\tconst factor=(offset-Sixi2['t'].angles.max)/Sixi2['t'].angles.max*.7\r\n\t\tleftFork.position.z=factor*Sixi2['t_l'].position[2]\r\n\t\trightFork.position.z=factor*Sixi2['t_r'].position[2]\r\n\t}\r\n\tscene.add(section3dObjs['1_Anchor.obj'])\r\n\tscene.add(section3dObjects['x'])\r\n}\r\n\r\nexport function datatTo3dObject(data,name,section3dObjs,section3dObjects){\r\n\tconst axis=new THREE.Vector3(...data.axis)\r\n\tconst sectionOuter=new THREE.Object3D()\r\n\tsectionOuter.name='section-'+name\r\n\tsectionOuter.position.set(...data.position)\r\n\tsectionOuter.setRotationFromAxisAngle(axis,data.angles.home*THREE.Math.DEG2RAD)\r\n\r\n\tconst sectionInner=new THREE.Object3D()\r\n\tsectionOuter.add(sectionInner)\r\n\tsectionInner.name='section-'+name+'-inner'\r\n\tdata.objs.map(o=>sectionInner.add(section3dObjs[o]))\r\n\r\n\tsectionOuter.sectionName=name\r\n\tsectionOuter.inner=sectionInner\r\n\tsectionOuter.axis=axis\r\n\tsectionOuter.rotateSection=function(angle){\r\n\t\tangle=THREE.Math.clamp(angle,data.angles.min,data.angles.max)\r\n\t\tif(sectionOuter.sectionAngle===angle) return\r\n\t\tsectionOuter.sectionAngle=angle\r\n\t\tsectionInner.setRotationFromAxisAngle(axis,-angle*THREE.Math.DEG2RAD)\r\n\t}\r\n\tsectionOuter.rotateSection(data.angles.home)\r\n\r\n\tif(data.parent)\r\n\t\tsection3dObjects[data.parent].inner.add(sectionOuter)\r\n\treturn sectionOuter\r\n}\r\n\r\nfunction render(){\r\n\trequestAnimationFrame(render)\r\n\tcontrols.update()\r\n\tcameraPos=controls.object.position\r\n\trenderer.render(scene,camera)\r\n}\r\n\r\nexport function poseLerp(a,b,alpha){\r\n\treturn _.mapValues(a,(v,i)=>THREE.Math.lerp(a[i],b[i],alpha))\r\n}\r\n\r\n// TODO: Add to helper lib\r\nfunction angleFromSSSTriangle(a,b,c){\r\n\treturn Math.acos((b**2+c**2-a**2)/(2*b*c))\r\n}\r\n\r\n// TODO: IK\r\n// TODO: Collision detection\r\n","import React from 'react'\r\n// import _ from 'lodash'\r\n\r\nimport './SegmentControls.scss'\r\n\r\nexport default function SegmentControls({onChange,...props}){\r\n\tconst value=Number.isInteger(props.value)?props.value:-1\r\n\treturn (\r\n\t\t<div {...props} className={'segment-controls row '+props.className}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"highlight\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\ttransform: `translateX(${value*100}%)`,\r\n\t\t\t\t\twidth: 100/props.children.length+'%',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{props.children.map((c,i)=><div key={i} {...props.childProps} onClick={()=>onClick(i)}>{c}</div>)}\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction onClick(index){\r\n\t\ttry{ onChange(index,value) }catch{}\r\n\t}\r\n}\r\n","import React,{useContext,/*Fragment*/} from 'react'\r\n\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport './HistoryTimeline.scss'\r\nimport PoseToImg from '../PoseToImg/PoseToImg'\r\n\r\n// NOTE: Maybe UI Toggle\r\n// TODO: Scroll\r\n\r\nexport let currentPose\r\nexport default function HistoryTimeline(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {historySeekPos,poseHistory,simPose,historyLockHand,historySeekbarPrecision}=state\r\n\tif(historySeekPos===poseHistory.length) currentPose=JSON.stringify(simPose)\r\n\treturn (\r\n\t\t<div id=\"HistoryTimeline\">\r\n\t\t\t<div className=\"row top-row\">\r\n\t\t\t\t<div className=\"f-center px-8 py-4 spb-x-8\">\r\n\t\t\t\t\t<div className=\"fa fa-history\"/>\r\n\t\t\t\t\t<div className=\"b-700\">History Timeline</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"f-center px-8 py-4 pr-0\">\r\n\t\t\t\t\t<span className=\"h7\">Don't affect Hand State</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"ml-8\"\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tchecked={historyLockHand}\r\n\t\t\t\t\t\tonChange={({target})=>{dispatch(['SET_HISTORY_LOCK_HAND',target.checked])}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row f-center spc-x-8 spc-4\" style={{visibility: poseHistory.length?'visible':'hidden'}}>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_backward\" onClick={()=>dispatch(['HISTORY_SEEK',poseHistory.length])}/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_backward\" onClick={()=>dispatch(['HISTORY_SEEK',Math.round(historySeekPos)+1])}/>\r\n\t\t\t\t\t<span className=\"h7\">Slider position</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"text-center h7 b-500\"\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\tvalue={historySeekPos}\r\n\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['HISTORY_SEEK',valueAsNumber])}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_forward\" onClick={()=>dispatch(['HISTORY_SEEK',Math.round(historySeekPos)-1])}/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_forward\" onClick={()=>dispatch(['HISTORY_SEEK',0])}/>\r\n\t\t\t\t</div>\r\n\t\t\t\t{/*<div className=\"f-center px-8 py-4 pr-0\">\r\n\t\t\t\t\t<span className=\"h7\">Smooth Seekbar</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"ml-8\"\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tchecked={historySeekbarPrecision==2}\r\n\t\t\t\t\t\tonChange={({target})=>{dispatch(['SET_STATE',{historySeekbarPrecision: target.checked?2:1}])}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>*/}\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<div className=\"fa fa-minus f-center px-16\" onClick={()=>dispatch(['SET_STATE',{showHistoryTimeline: false}])}/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"scroll-x\">\r\n\t\t\t\t<div className=\"seekbar f-center\" style={{height: '30px'}}>\r\n\t\t\t\t\t<div className=\"text-center h7\"><i className=\"fa fa-chevron-down mr-4\"/>Current</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tposeHistory.length>=1?\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\tmax={poseHistory.length}\r\n\t\t\t\t\t\t\t\tstep={1/10**historySeekbarPrecision}\r\n\t\t\t\t\t\t\t\tvalue={historySeekPos}\r\n\t\t\t\t\t\t\t\tonChange={({target:{valueAsNumber}})=>dispatch(['HISTORY_SEEK',valueAsNumber])}\r\n\t\t\t\t\t\t\t\tstyle={{width: (poseHistory.length)*136+'px'}}\r\n\t\t\t\t\t\t\t/>:undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex\">\r\n\t\t\t\t\t<div className=\"p-8 current d-flex\">\r\n\t\t\t\t\t\t<PoseToImg cache={false} pose={currentPose} onClick={()=>dispatch(['HISTORY_SEEK',poseHistory.length])}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"f-grow-1 row spc-8 f-nowrap f-horz-rev f-justify-end\">\r\n\t\t\t\t\t\t{poseHistory.map((p,i)=><PoseToImg key={i} pose={p} onClick={()=>dispatch(['HISTORY_SEEK',i])}/>)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","// import _ from 'lodash'\r\nimport * as THREE from 'three'\r\nimport axios from 'axios'\r\n\r\nimport {\r\n\tsection3dObjects,\r\n\tsetupThisRenderer as simRobotResize,\r\n\tposeLerp,\r\n\tscene as simScene,\r\n\tendAffector3dObject,\r\n} from '../components/SimRobot/SimRobot'\r\nimport Sixi2 from '../model/Sixi2'\r\nimport {currentPose} from '../components/HistoryTimeline/HistoryTimeline'\r\n\r\nexport let currentState={}\r\nexport let prevPose\r\nexport let prevBottomExpanded\r\nexport const mainReducer=(state,[actionType,data])=>{\r\n\tcurrentState=reducer(state,actionType,data)\r\n\tif(currentState.isPolling==='false') currentState.isPolling=false\r\n\tif(currentState.isPolling==='true') currentState.isPolling=true\r\n\tif(prevBottomExpanded !== (state.showHistoryTimeline || state.showSequenceControl)){\r\n\t\tconsole.log('Bottom drawer changed')\r\n\t\twindow.setTimeout(simRobotResize,0)\r\n\t\tprevBottomExpanded=state.showHistoryTimeline || state.showSequenceControl\r\n\t}\r\n\tif(actionType==='SET_SIM_ANGLES') currentState.historySeekPos=state.poseHistory.length\r\n\r\n\t// console.log(data,actionType,currentState)\r\n\treturn currentState\r\n}\r\n\r\n// RULE: Do not use currentState below\r\nfunction reducer(state,actionType,data){\r\n\tlet pose\r\n\tswitch(actionType){\r\n\t\tcase 'SET_STATE':\r\n\t\t\treturn {...state,...data}\r\n\t\tcase 'SET_SIM_ANGLES':\r\n\t\t\tfor(let i in data){\r\n\t\t\t\tdata[i]=THREE.Math.clamp(+data[i].toFixed(3),Sixi2[i].angles.min,Sixi2[i].angles.max)\r\n\t\t\t\tsection3dObjects[i].rotateSection(data[i])\r\n\t\t\t}\r\n\t\t\tsimScene.updateMatrixWorld()\r\n\t\t\tlet pos=new THREE.Vector3()\r\n\t\t\tsection3dObjects['v'].getWorldPosition(pos)\r\n\t\t\tendAffector3dObject.position.set(...pos.toArray())\r\n\t\t\treturn {...state,simPose: data}\r\n\t\tcase 'GO':\r\n\t\t\t// TODO: check\r\n\t\t\tif(state.online) axios.put(`https://${state.IP}:7878/goto`,state.simPose)\r\n\t\t\tpose=JSON.stringify(state.simPose)\r\n\t\t\tif(prevPose!==pose){\r\n\t\t\t\tstate.poseHistory.push(pose)\r\n\t\t\t\tstate.historySeekPos=state.poseHistory.length\r\n\t\t\t\tprevPose=pose\r\n\t\t\t}\r\n\t\t\treturn {...state}\r\n\t\tcase 'HISTORY_SEEK':\r\n\t\t\tif(isNaN(+data)) data=0\r\n\t\t\tdata=THREE.Math.clamp(+data,0,state.poseHistory.length)\r\n\t\t\tlet a=Math.floor(data)\r\n\t\t\tlet b=Math.ceil(data)\r\n\t\t\tconst alpha=+((data%1).toFixed(state.historySeekbarPrecision))\r\n\t\t\t// const alpha=data%1\r\n\t\t\tconst c=JSON.parse(currentPose)\r\n\t\t\ta=a>=state.poseHistory.length?c:JSON.parse(state.poseHistory[a])\r\n\t\t\tb=b>=state.poseHistory.length?c:JSON.parse(state.poseHistory[b])\r\n\t\t\tconst p=poseLerp(a,b,alpha)\r\n\t\t\tif(state.historyLockHand) p['t']=c['t']\r\n\t\t\treturn reducer({...state,historySeekPos: data},'SET_SIM_ANGLES',p)\r\n\t\tcase 'SET_HISTORY_LOCK_HAND':\r\n\t\t\treturn reducer({...state,historyLockHand: data},'HISTORY_SEEK',state.historySeekPos)\r\n\t\tdefault: return state\r\n\t}\r\n}\r\n","import React,{createContext,useReducer,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\nimport _ from 'lodash'\r\nimport axios from 'axios'\r\n\r\nimport {mainReducer} from '../reducers/mainReducer'\r\nimport sections from '../model/Sixi2'\r\nimport {currentState} from '../reducers/mainReducer'\r\n\r\nexport let dispatch\r\nexport const prodMode=true\r\n\r\n// TODO: Update port\r\nexport const homePose=JSON.stringify(_.mapValues(sections,s=>s.angles.home))\r\nexport let realPose=JSON.parse(homePose)\r\nexport let targetPose=JSON.parse(homePose)\r\nexport const initState=JSON.stringify({\r\n\tisPolling: prodMode?true:false,\r\n\tIP: '',\r\n\r\n\tsimPose: JSON.parse(homePose),\r\n\tonline: false,\r\n\tcamFeedState: 'searching',\r\n\tcamFeedMaximize: false,\r\n\tisPoseToImgReady: false,\r\n\r\n\tshowHistoryTimeline: true,\r\n\tshowSequenceControl: false,\r\n\tshowLibrary: false,\r\n\r\n\tposeHistory: [],\r\n\thistorySeekPos: 0,\r\n\thistoryLockHand: true,\r\n\thistorySeekbarPrecision: 2,\r\n})\r\nexport const MainContext=createContext(JSON.parse(initState))\r\nexport const current={} // state,dispatch\r\nexport const urlStateParamList=['IP','isPolling']\r\n\r\nlet mounted=false\r\nexport default withRouter(function MainContextProvider({children,location,history}){\r\n\tlet state\r\n\t([state,dispatch]=useReducer(mainReducer,JSON.parse(initState)))\r\n\r\n\tuseEffect(componentDidMount,[])\r\n\tuseEffect(stateToUrl,[...urlStateParamList.map(p=>state[p]),location.pathname])\r\n\tuseEffect(onSetIP,[state.IP])\r\n\r\n\t// console.log('MainContextProvider render')\r\n\treturn <MainContext.Provider value={{state,dispatch}}>{children}</MainContext.Provider>\r\n\r\n\tfunction componentDidMount(){\r\n\t\tconsole.log('componentDidMount')\r\n\t\tconst stateFromUrl=_.pick(Object.fromEntries(new URLSearchParams(location.search)),urlStateParamList)\r\n\t\tdispatch(['SET_STATE',stateFromUrl])\r\n\t\twindow.setInterval(()=>{\r\n\t\t\tif(currentState.isPolling){\r\n\t\t\t\t// console.log(currentState)\r\n\t\t\t\taxios.get(`https://${currentState.IP}:7878/live`).then(res=>{\r\n\t\t\t\t\t// console.log(res.data)\r\n\t\t\t\t\t// dispatch(['SET_ACTUAL_ANGLES',res.data])\r\n\t\t\t\t\trealPose={...JSON.parse(homePose),...res.data.position}\r\n\t\t\t\t\ttargetPose={...JSON.parse(homePose),...res.data.target}\r\n\t\t\t\t\tdispatch(['SET_STATE',{online: true}])\r\n\t\t\t\t}).catch(err=>dispatch(['SET_STATE',{online: false}]))\r\n\t\t\t}\r\n\t\t},1000)\r\n\t}\r\n\r\n\tfunction stateToUrl(){\r\n\t\tconsole.log('stateToUrl')\r\n\t\tif(mounted)\r\n\t\t\thistory.replace(location.pathname+'?'+new URLSearchParams(_.pick(state,urlStateParamList)).toString())\r\n\t\telse{\r\n\t\t\thistory.replace('/login?'+new URLSearchParams(_.pick(state,urlStateParamList)).toString())\r\n\t\t\tmounted=true\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO: Robot nickname, firmware versions\r\n\tfunction onSetIP(){\r\n\t\tdispatch(['SET_STATE',{camFeedState: 'searching'}])\r\n\t}\r\n})\r\n","import React,{useContext,/*Fragment,*/useState} from 'react'\r\nimport axios from 'axios'\r\n\r\nimport './RightSidebar.scss'\r\nimport {MainContext,homePose,targetPose,realPose} from '../../contexts/MainContext'\r\nimport Sixi2 from '../../model/Sixi2'\r\nimport Accordion from '../../utilities/Accordion/Accordion'\r\n\r\n// TODO: End Affector Status\r\n// TODO: Speed & accl\r\n// TODO: Disable sidebar if historySeekPos!==poseHistory\r\n\r\nlet state,dispatch\r\nexport default function RightSidebar(){\r\n\t({state,dispatch}=useContext(MainContext))\r\n\treturn (\r\n\t\t<div id=\"RightSidebar\" className=\"row f-vert f-nowrap scroll-y\">\r\n\t\t\t{/*<div className=\"b-600 p-12\">Sim Robot Controls</div>*/}\r\n\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t<Accordion head={'Arm Angles'} maxHeight=\"176 px\">\r\n\t\t\t\t\t{['x','y','z'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t</Accordion>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t<Accordion head={'Wrist Angles'} maxHeight=\"176 px\">\r\n\t\t\t\t\t{['u','v','w'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t</Accordion>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"accordion-container\">\r\n\t\t\t\t<Accordion head={'Hand State'} maxHeight=\"64 px\">\r\n\t\t\t\t\t{['t'].map(i=><SectionInput {...{i}} key={i}/>)}\r\n\t\t\t\t</Accordion>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"col-extrude row spc-12 f-vert\">\r\n\t\t\t\t<div className=\"button-icon\" onClick={()=>dispatch(['SET_SIM_ANGLES',JSON.parse(homePose)])}>\r\n\t\t\t\t\t<div className=\"icon icon-home text-muted\"/>\r\n\t\t\t\t\t<div className=\"col\">Load Home Pose</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"button-icon\" onClick={()=>dispatch(['SET_SIM_ANGLES',realPose])}>\r\n\t\t\t\t\t<div className=\"icon icon-joystick text-muted\"/>\r\n\t\t\t\t\t<div className=\"col\">Load Real World Pose</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"button-icon\" onClick={()=>dispatch(['SET_SIM_ANGLES',targetPose])}>\r\n\t\t\t\t\t<div className=\"icon icon-node_link_direction text-muted\"/>\r\n\t\t\t\t\t<div className=\"col\">Load Target Pose</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"f-grow-1\"></div>\r\n\t\t\t{/* TODO: Halt*/}\r\n\t\t\t<div className=\"col-extrude row spc-12 f-vert\">\r\n\t\t\t\t{/*<div className=\"col-extrude row spc-12 f-center\">*/}\r\n\t\t\t\t\t{/*<input type=\"checkbox\" checked={state.isPolling} onChange={({target})=>dispatch(['SET_STATE',{isPolling: target.checked}])}/>*/}\r\n\t\t\t\t\t{/*<div>Show live position</div>*/}\r\n\t\t\t\t\t{/*<div className=\"h7 ml-auto mt-12\">{state.isPolling?(state.online?'Online':'Offline'):undefined}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"button outline row f-center\" onClick={()=>axios.put(`https://${state.IP}:7878/stop`)}>\r\n\t\t\t\t\t<div className=\"icon-stop super-center\" style={{fontSize: '11px'}}/>\r\n\t\t\t\t\t<div className=\"col text-center\">Emergency Stop</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"button outline row f-center\" onClick={()=>dispatch(['GO'])}>\r\n\t\t\t\t\t<div className=\"icon-play super-center\"/>\r\n\t\t\t\t\t<div className=\"col text-center\">Go</div>\r\n\t\t\t\t</div>*/}\r\n\t\t\t\t{/*\r\n\t\t\t\t\tstate.showSequenceControl?\r\n\t\t\t\t\t\t<div className=\"button outline row f-center\">\r\n\t\t\t\t\t\t\t<div className=\"fa fa-forward super-center\"/>\r\n\t\t\t\t\t\t\t<div className=\"col text-center\">Play Sequence</div>\r\n\t\t\t\t\t\t</div>:undefined\r\n\t\t\t\t*/}\r\n\t\t\t\t<div className=\"controls\">\r\n\t\t\t\t\t<div className=\"h7\">{state.isPolling?(state.online?'Online':'Offline'):undefined}</div>\r\n\t\t\t\t\t<div className=\"go\" onClick={()=>dispatch(['GO'])}>Go</div>\r\n\t\t\t\t\t<div className=\"button-icon\" onClick={()=>axios.put(`https://${state.IP}:7878/stop`)}>\r\n\t\t\t\t\t\t<div className=\"icon icon-stop super-center\" style={{fontSize: '11px'}}/>\r\n\t\t\t\t\t\t<div className=\"f-grow-1\">Stop</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nfunction SectionInput({i}){\r\n\tconst section=Sixi2[i]\r\n\tconst [resetActive,setResetActive]=useState(false)\r\n\treturn (\r\n\t\t<div className=\"p-8 pt-2\">\r\n\t\t\t<div className=\"row mt-0\">\r\n\t\t\t\t<label className=\"uppercase\">{i}</label>\r\n\t\t\t\t<div className=\"col\" style={{height: '30px'}}>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\tmin={section.angles.min}\r\n\t\t\t\t\t\tmax={section.angles.max}\r\n\t\t\t\t\t\tvalue={+state.simPose[i].toFixed(1)}\r\n\t\t\t\t\t\t{...{onChange}}\r\n\t\t\t\t\t\tstep=\".1\"/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"trim sliding-row\">\r\n\t\t\t\t<div className={'row f-nowrap mt-0'+(resetActive?' active':'')}>\r\n\t\t\t\t\t<div className=\"col-6 row mr-8\">\r\n\t\t\t\t\t\t<div className=\"button outline super-center icon-reply p-0\" title=\"Reset\" onClick={()=>setResetActive(true)}/>\r\n\t\t\t\t\t\t<div className=\"pl-10 col row f-justify-space-between\">\r\n\t\t\t\t\t\t\t<div className=\"col text-muted h7\">{+section.angles.min.toFixed(1)}</div>\r\n\t\t\t\t\t\t\t{/*<div className=\"col text-center b-500\">{state.simPose[i]}</div>*/}\r\n\t\t\t\t\t\t\t{/*<input className=\"text-center py-2\" type=\"number\" pattern=\"-?[0-9]+(\\.[0-9]{0,3})?\" value={state.simPose[i]} {...{onChange}}/>*/}\r\n\t\t\t\t\t\t\t<input className=\"text-center py-2\" type=\"number\" value={state.simPose[i]} {...{onChange}}/>\r\n\t\t\t\t\t\t\t<div className=\"col text-muted h7 text-right\">{+section.angles.max.toFixed(1)}</div>\r\n\t\t\t\t\t\t\t<div className=\"row-breaker\"/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col-6 row mr-8 f-center\">\r\n\t\t\t\t\t\t<div className=\"button outline super-center icon-cross_mark\" onClick={()=>setResetActive(false)}/>\r\n\t\t\t\t\t\t<div className=\"mr-auto ml-8\">Reset to:</div>\r\n\t\t\t\t\t\t<button title=\"Home angle\" className=\"outline ml-8 h8 icon-home\" style={{height: '22px'}} onClick={()=>onClick(JSON.parse(homePose)[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t\t<button title=\"Actual angle\" className=\"outline ml-8 h8 icon-joystick\" style={{height: '22px'}} onClick={()=>onClick(realPose[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t\t<button title=\"Target angle\" className=\"outline ml-8 h8 icon-node_link_direction\" style={{height: '22px'}} onClick={()=>onClick(targetPose[i])} tabIndex=\"-1\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n\r\n\tfunction onClick(pose){\r\n\t\tsetResetActive(false)\r\n\t\tonChange({target:{valueAsNumber:pose}})\r\n\t}\r\n\r\n\tfunction onChange({target:{valueAsNumber}}){\r\n\t\tdispatch(['SET_SIM_ANGLES',{...state.simPose,[i]: valueAsNumber}])\r\n\t}\r\n}\r\n","import React,{useContext,useState,useEffect} from 'react'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nimport './Login.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default withRouter(function Login({history}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst [isMounted,setIsMounted]=useState(false)\r\n\r\n\tuseEffect(()=>setIsMounted(true),[])\r\n\r\n\t// console.log('Login render')\r\n\treturn (\r\n\t\t<form id=\"Login\" className={isMounted?'active':undefined} {...{onSubmit}}>\r\n\t\t\t<section>\r\n\t\t\t\t{isMounted?<style>\r\n\t\t\t\t\t#cam-feed,\r\n\t\t\t\t\t#cam-feed:hover:not(.active)&#123;\r\n\t\t\t\t\t\tz-index: 1;\r\n\t\t\t\t\t\ttransform: scale(1,1);\r\n\t\t\t\t\t\tright: calc(50% - 320px);\r\n\t\t\t\t\t\tbottom: calc(50% - 213px);\r\n\t\t\t\t\t\tborder-radius: 6px;\r\n\t\t\t\t\t\ttransition: opacity .5s;\r\n\t\t\t\t\t&#125;\r\n\t\t\t\t</style>:undefined}\r\n\t\t\t\t<div className=\"cam-feed-container\"/>\r\n\t\t\t\t<div className=\"row spc-12 f-center\">\r\n\t\t\t\t\t<label htmlFor=\"login-ip\">Robot Address / IP</label>\r\n\t\t\t\t\t<div className=\"button outline text-muted\" style={{borderRadius: '4px 0 0 4px',cursor: 'initial'}}>https://</div>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tid=\"login-ip\"\r\n\t\t\t\t\t\tclassName=\"col col-extrude-l\"\r\n\t\t\t\t\t\tstyle={{borderRadius: '0 4px 4px 0'}}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"Robot IP\"\r\n\t\t\t\t\t\tvalue={state.IP}\r\n\t\t\t\t\t\tonChange={({target})=>dispatch(['SET_STATE',{IP: target.value}])}/>\r\n\t\t\t\t\t<button className=\"outline\">Go</button>\r\n\t\t\t\t</div>\r\n\t\t\t</section>\r\n\t\t</form>\r\n\t)\r\n\r\n\tfunction onSubmit(e){\r\n\t\te.preventDefault()\r\n\t\tsetIsMounted(false)\r\n\t\twindow.setTimeout(()=>history.push('/'),500)\r\n\t}\r\n})\r\n","import React,{Fragment,useState} from 'react'\r\nimport './Accordion.css'\r\n\r\n// TODO: headProps,bodyProps,bodyInnerProps\r\nexport default function Accordion(props){\r\n\tconst [state,setState]=useState({expanded: true,maxHeight: undefined})\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<div\r\n\t\t\t\tid={props.id}\r\n\t\t\t\tclassName={'accordion'+(props.className ?? '')+(state.expanded?' expanded':'')}\r\n\t\t\t\t{...{onClick}}\r\n\t\t\t>{props.head}</div>\r\n\t\t\t<div style={{maxHeight: state.maxHeight}}>\r\n\t\t\t\t<div>{props.children}</div>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t)\r\n\r\n\tfunction onClick({currentTarget}){\r\n\t\tconst maxHeight=currentTarget.nextSibling.children[0].offsetHeight\r\n\t\tcurrentTarget.nextSibling.style.maxHeight=maxHeight+'px'\r\n\t\t// setExpanded(!expanded)\r\n\t\tsetTimeout(()=>setState({expanded: !state.expanded,maxHeight}),0)\r\n\t}\r\n}\r\n","import React,{useContext} from 'react'\r\n\r\nimport './SequenceControls.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\nexport default function SequenceControls(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\treturn (\r\n\t\t<div id=\"SequenceControls\">\r\n\t\t\t<div className=\"top-row row\">\r\n\t\t\t\t<div className=\"f-center px-8 py-4 spb-x-8\">\r\n\t\t\t\t\t<div className=\"icon icon-layout_directed\"/>\r\n\t\t\t\t\t<div className=\"b-700\">Sequence Controls</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row f-center spc-x-8 spc-4\">\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_backward\"/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_backward\"/>\r\n\t\t\t\t\t<span className=\"h7\">Slider position</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName=\"text-center h7 b-500\"\r\n\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-step_forward\"/>\r\n\t\t\t\t\t<button className=\"outline super-center h7 icon icon-fast_forward\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"col\"/>\r\n\t\t\t\t<div className=\"px-8 py-4\">\r\n\t\t\t\t\t<button className=\"outline super-center\" style={{fontSize: '14px'}}>\r\n\t\t\t\t\t\t<i className=\"fa fa-bookmark mr-6\"/>\r\n\t\t\t\t\t\tSave Sequence\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"fa fa-minus f-center px-16 ml-auto\" onClick={()=>dispatch(['SET_STATE',{showSequenceControl: false}])}/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"seekbar f-center\" style={{height: '30px'}}>\r\n\t\t\t\t<div className=\"h7 text-center\">Seekbar</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext} from 'react'\r\n\r\nimport './BottomDrawer.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\nimport HistoryTimeline from '../HistoryTimeline/HistoryTimeline'\r\nimport SequenceControls from '../SequenceControls/SequenceControls'\r\n\r\nexport default function BottomDrawer(){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\tconst {showHistoryTimeline,showSequenceControl,showLibrary}=state\r\n\treturn (\r\n\t\t<div id=\"BottomDrawer\">\r\n\t\t\t{(showHistoryTimeline || showSequenceControl)===false?<style>:root&#123; --bottomDrawerHeight: 46px &#125;</style>:undefined}\r\n\t\t\t<div id=\"taskbar\" className=\"row spc-8 f-end\">\r\n\t\t\t\t<div className={'button outline row f-center'+(showHistoryTimeline?' active':'')} onClick={()=>dispatch(['SET_STATE',{showHistoryTimeline: !showHistoryTimeline}])}>\r\n\t\t\t\t\t<div className=\"fa fa-history super-center\"/>\r\n\t\t\t\t\t<div className=\"col text-center mr-m30\">History Timeline</div>\r\n\t\t\t\t\t<div className=\"fa fa-history super-center\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={'button outline row f-center'+(showSequenceControl?' active':'')} onClick={()=>dispatch(['SET_STATE',{showSequenceControl: !showSequenceControl}])}>\r\n\t\t\t\t\t<div className=\"icon-layout_directed super-center\"/>\r\n\t\t\t\t\t<div className=\"col text-center mr-m30\">Sequence Controls</div>\r\n\t\t\t\t\t<div className=\"icon-layout_directed super-center\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={'button outline row f-center'+(showLibrary?' active':'')} onClick={()=>dispatch(['SET_STATE',{showLibrary: !showLibrary}])}>\r\n\t\t\t\t\t<div className=\"fa fa-bookmark super-center\"/>\r\n\t\t\t\t\t<div className=\"col text-center mr-m30\">Library</div>\r\n\t\t\t\t\t<div className=\"fa fa-bookmark super-center\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ml-auto h7\">App Version: 0.1.5</div>\r\n\t\t\t</div>\r\n\t\t\t{showHistoryTimeline?<HistoryTimeline/>:undefined}\r\n\t\t\t{showSequenceControl?<SequenceControls/>:undefined}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import React,{useContext,Fragment} from 'react'\r\n\r\nimport './CamFeed.scss'\r\nimport {MainContext} from '../../contexts/MainContext'\r\n\r\n// TODO: camFeedState!=='found'\r\nexport default function CamFeed({className,children}){\r\n\tconst {state,dispatch}=useContext(MainContext)\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<style>\r\n\t\t\t\t#cam-feed&#123;\r\n\t\t\t\t\t{state.camFeedState!=='found'?'opacity: 0':undefined}\r\n\t\t\t\t&#125;\r\n\t\t\t</style>\r\n\t\t\t<img id=\"cam-feed\"\r\n\t\t\t\tclassName={state.camFeedMaximize?'active':''}\r\n\t\t\t\tsrc={`http://${state.IP}:8081/?action=stream`}\r\n\t\t\t\talt=\"Cam feed\"\r\n\t\t\t\tonClick={()=>dispatch(['SET_STATE',{camFeedMaximize: !state.camFeedMaximize}])}\r\n\t\t\t\tonLoad={()=>dispatch(['SET_STATE',{camFeedState: 'found'}])}\r\n\t\t\t\tonError={()=>dispatch(['SET_STATE',{camFeedState: 'not found'}])}\r\n\t\t\t/>\r\n\t\t</Fragment>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport './Header.scss'\r\n\r\n// TODO: Robot name\r\nexport default function Header(){\r\n\treturn (\r\n\t\t<header id=\"Header\" className=\"row spc-8 spc-x-16 f-center\">\r\n\t\t\t<img src={require('../../assets/imgs/icon_logo.svg')} alt=\"\"/>\r\n\t\t\t<div className=\"b-600 uppercase\">\r\n\t\t\t\t<div className=\"h5\">Marginally Clever</div>\r\n\t\t\t\t<div className=\"h8 text-muted\">Robot Overlord - III</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"col\"/>\r\n\t\t\t<Link to=\"/login\" className=\"button-icon\">\r\n\t\t\t\t<div className=\"fa fa-power-off text-muted\"/>\r\n\t\t\t\t<div>Login</div>\r\n\t\t\t</Link>\r\n\t\t\t<Link to=\"/login\" className=\"button-icon\">\r\n\t\t\t\t<div className=\"fa fa-cogs text-muted\"/>\r\n\t\t\t\t<div>Settings</div>\r\n\t\t\t</Link>\r\n\t\t\t<div className=\"button-icon\" onClick={()=>window.location.reload()}>\r\n\t\t\t\t<div className=\"fa fa-refresh text-muted\"/>\r\n\t\t\t\t<div>Reload</div>\r\n\t\t\t</div>\r\n\t\t</header>\r\n\t)\r\n}\r\n","import React,{/*useContext*/} from 'react'\nimport {Route,withRouter,/*Link*/} from 'react-router-dom'\n\nimport './App.scss'\nimport Login from '../Login/Login'\n// import {MainContext} from '../../contexts/MainContext'\n// import RobotView from '../RobotView/RobotView'\nimport SimRobot from '../SimRobot/SimRobot'\nimport RightSidebar from '../RightSidebar/RightSidebar'\nimport BottomDrawer from '../BottomDrawer/BottomDrawer'\nimport CamFeed from '../CamFeed/CamFeed'\nimport Header from '../Header/Header'\n\nexport default withRouter(function App(){\n\t// const {state,dispatch}=useContext(MainContext)\n\n\t// console.log('App render')\n\treturn (\n\t\t<div id=\"App\">\n\t\t\t{/*<RobotView/>*/}\n\t\t\t<div className=\"pos-rel\">\n\t\t\t\t<SimRobot/>\n\t\t\t\t<Header/>\n\t\t\t</div>\n\t\t\t<RightSidebar/>\n\t\t\t<CamFeed/>\n\t\t\t<BottomDrawer/>\n\t\t\t<Route path=\"/login\" component={Login}/>\n\t\t</div>\n\t)\n})\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {HashRouter} from 'react-router-dom'\n\nimport './index.scss'\nimport App from './components/App/App'\nimport * as serviceWorker from './serviceWorker'\nimport MainContextProvider from './contexts/MainContext'\n\n// TODO: Pose class\n\nReactDOM.render(\n\t// <React.StrictMode>\n\t\t<HashRouter>\n\t\t\t<MainContextProvider>\n\t\t\t\t<App/>\n\t\t\t</MainContextProvider>\n\t\t</HashRouter>\n\t// </React.StrictMode>\n\t,document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}